<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô (Sadao Modern V3.0)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sarabun:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --gold-main: #D4AF37; 
            --gold-light: #F9E79F;
            --green-deep: #1B4D3E; 
        }
        body { 
            font-family: 'Prompt', sans-serif; 
            background-color: #f0f2f5;
            background-image: 
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
            color: #333; 
            overflow-x: hidden; 
            min-height: 100vh;
        }
        
        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        /* Loading Spinner */
        #loading { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.8); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; backdrop-filter: blur(8px); }
        .spinner { width: 60px; height: 60px; border: 6px solid #f3f3f3; border-top: 6px solid var(--gold-main); border-radius: 50%; animation: spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Card Flip Mechanics */
        .card-scene { width: 100%; max-width: 420px; margin: 0 auto; min-height: 100vh; perspective: 1500px; padding: 20px; display: flex; align-items: center; }
        .card-object { width: 100%; position: relative; transform-style: preserve-3d; transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55); border-radius: 30px; }
        .card-face { width: 100%; border-radius: 30px; backface-visibility: hidden; min-height: 750px; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        .card-front { transform: rotateY(0deg); background: white; }
        .card-back { position: absolute; top: 0; left: 0; height: 100%; transform: rotateY(180deg); background: white; }
        .is-flipped { transform: rotateY(180deg); }

        /* Effects Container */
        .fx-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; overflow: hidden; }
        
        /* Specific Animations */
        @keyframes floatUp { 0% { transform: translateY(100vh) scale(0.5); opacity: 0; } 50% { opacity: 0.8; } 100% { transform: translateY(-100px) scale(1); opacity: 0; } }
        @keyframes fallDown { 0% { transform: translateY(-50px) rotate(0deg); } 100% { transform: translateY(100vh) rotate(360deg); } }
        @keyframes rainDrop { 0% { transform: translateY(-100vh); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(100vh); opacity: 0; } }
        @keyframes sunPulse { 0% { transform: scale(1); opacity: 0.6; } 50% { transform: scale(1.2); opacity: 0.9; } 100% { transform: scale(1); opacity: 0.6; } }
        @keyframes windBlow { 0% { transform: translateX(-100px) translateY(0); opacity: 0; } 50% { opacity: 0.5; } 100% { transform: translateX(500px) translateY(20px); opacity: 0; } }

        /* Particle Classes */
        .particle-ember { position: absolute; width: 6px; height: 6px; background: #FF5E62; border-radius: 50%; filter: blur(1px); animation: floatUp linear infinite; }
        .particle-bubble { position: absolute; border: 2px solid rgba(54, 209, 220, 0.5); border-radius: 50%; animation: floatUp ease-in infinite; }
        .particle-leaf { position: absolute; width: 10px; height: 10px; background: #81C784; border-radius: 2px 10px; animation: fallDown linear infinite; }
        .particle-rain { position: absolute; width: 2px; height: 40px; background: linear-gradient(to bottom, transparent, #42a5f5); animation: rainDrop linear infinite; }
        .particle-sun { position: absolute; top: -100px; right: -100px; width: 400px; height: 400px; background: radial-gradient(circle, rgba(255,200,50,0.4) 0%, rgba(255,255,255,0) 70%); animation: sunPulse 6s ease-in-out infinite; }
        .particle-cloud { position: absolute; background: rgba(255,255,255,0.4); border-radius: 50px; filter: blur(15px); animation: windBlow linear infinite; }

        /* UI Elements */
        .front-content { position: relative; z-index: 10; padding: 40px 24px; display: flex; flex-direction: column; height: 100%; }
        .logo-box { width: 110px; height: 110px; margin: 0 auto 15px; background: white; border-radius: 50%; padding: 5px; box-shadow: 0 10px 25px rgba(212, 175, 55, 0.3); border: 4px solid var(--gold-main); animation: floatLogo 5s ease-in-out infinite; }
        @keyframes floatLogo { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        
        .input-group { margin-bottom: 20px; position: relative; transition: all 0.3s; }
        .input-group:focus-within { transform: translateY(-2px); }
        .input-label { position: absolute; top: -10px; left: 15px; background: var(--green-deep); padding: 2px 12px; color: white; font-size: 12px; font-weight: 600; border-radius: 20px; z-index: 20; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .custom-select { width: 100%; padding: 16px; border: 2px solid #e0e0e0; border-radius: 18px; font-family: 'Prompt'; background: #fff; outline: none; transition: border 0.3s; appearance: none; font-size: 16px; color: #444; }
        .custom-select:focus { border-color: var(--gold-main); box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.1); }

        .btn-gold { background: linear-gradient(135deg, #1B4D3E, #0f3025); color: #F9E79F; padding: 18px; width: 100%; border-radius: 18px; font-size: 18px; font-weight: bold; border: none; cursor: pointer; position: relative; z-index: 20; transition: all 0.2s; box-shadow: 0 10px 20px rgba(27, 77, 62, 0.3); display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-gold:active { transform: scale(0.96); box-shadow: 0 5px 10px rgba(27, 77, 62, 0.3); }

        /* Weather Badge */
        .weather-card { margin-top: auto; border-radius: 24px; padding: 20px; position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.8); }
        .weather-icon-lg { font-size: 40px; color: var(--green-deep); opacity: 0.2; position: absolute; right: 10px; bottom: 10px; }

        /* Result Styles */
        .result-header { padding: 40px 20px 50px; text-align: center; color: white; border-radius: 0 0 50px 50px; position: relative; z-index: 10; overflow: hidden; }
        .avatar-frame { width: 140px; height: 140px; margin: 0 auto 10px; border-radius: 50%; border: 5px solid rgba(255,255,255,0.5); overflow: hidden; background: white; box-shadow: 0 10px 30px rgba(0,0,0,0.2); position: relative; z-index: 20; }
        .back-content { flex-grow: 1; overflow-y: auto; padding: 20px; z-index: 10; margin-top: -30px; padding-bottom: 80px; }
        
        .chip { display: inline-flex; align-items: center; padding: 8px 16px; background: white; border: 1px solid #eee; border-radius: 25px; font-size: 13px; color: #555; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.03); margin-bottom: 8px; margin-right: 4px; }
        .chip:active { transform: scale(0.95); }
        .chip.selected { background: var(--green-deep); color: #F9E79F; border-color: var(--green-deep); box-shadow: 0 4px 12px rgba(27, 77, 62, 0.4); font-weight: 500; }
        .chip.selected i { display: inline-block !important; }

        .section-header { display: flex; align-items: center; gap: 10px; margin: 25px 0 15px; font-weight: 700; color: var(--green-deep); font-size: 16px; }
        .section-line { flex-grow: 1; height: 1px; background: #eee; }
        
        .food-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }
        .food-item { background: white; border-radius: 12px; padding: 10px; text-align: center; border: 1px solid #f0f0f0; font-size: 12px; transition: all 0.2s; text-decoration: none; color: #333; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .food-item:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-color: var(--gold-main); }
        
        .save-bar { position: absolute; bottom: 0; left: 0; width: 100%; padding: 15px 20px; background: white; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); z-index: 50; display: flex; gap: 10px; }
        .btn-reset { width: 50px; height: 50px; border-radius: 50%; border: none; background: #eee; color: #555; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .btn-save { flex-grow: 1; border: none; background: #333; color: white; border-radius: 25px; font-weight: 600; font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }

        /* Scrollbar Hide */
        ::-webkit-scrollbar { width: 0px; background: transparent; }
    </style>
</head>
<body class="flex flex-col items-center justify-center">

    <div id="loading">
        <div class="spinner"></div>
        <p class="mt-4 text-green-900 font-bold animate-pulse">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ú‡∏π‡∏Å‡∏î‡∏ß‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô...</p>
    </div>

    <div class="card-scene">
        <div id="cardObject" class="card-object">
            
            <div id="cardFront" class="card-face card-front glass-panel">
                <div id="frontFx" class="fx-container"></div>
                
                <div class="front-content">
                    <div class="text-center mb-8 relative z-10">
                        <div class="logo-box">
                            <img src="https://img5.pic.in.th/file/secure-sv1/2613be45e1aa0f1e99dd6a6f89e87139.png" class="w-full h-full object-contain p-2">
                        </div>
                        <h1 class="text-2xl font-bold text-gray-800">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</h1>
                        <p class="text-xs font-medium text-yellow-600 bg-yellow-50 inline-block px-3 py-1 rounded-full mt-2 border border-yellow-200">Sadao Hospital Official</p>
                    </div>

                    <div class="space-y-6 relative z-10">
                        <div class="input-group">
                            <span class="input-label"><i class="fas fa-calendar-day mr-1"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î</span>
                            <select id="inputDay" class="custom-select"></select>
                            <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 pointer-events-none"></i>
                        </div>
                        <div class="input-group">
                            <span class="input-label"><i class="fas fa-calendar-alt mr-1"></i> ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</span>
                            <select id="inputMonth" class="custom-select"></select>
                            <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 pointer-events-none"></i>
                        </div>
                        <div class="input-group">
                            <span class="input-label"><i class="fas fa-history mr-1"></i> ‡∏õ‡∏µ ‡∏û.‡∏®. ‡πÄ‡∏Å‡∏¥‡∏î</span>
                            <select id="inputYear" class="custom-select"></select>
                            <i class="fas fa-chevron-down absolute right-4 top-4 text-gray-400 pointer-events-none"></i>
                        </div>
                    </div>

                    <button onclick="startAnalysis()" class="btn-gold mt-8">
                        <span>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</span> <i class="fas fa-arrow-right"></i>
                    </button>

                    <div class="weather-card glass-panel mt-auto">
                        <div class="flex items-start justify-between relative z-10">
                            <div>
                                <div class="text-[10px] text-gray-500 font-semibold uppercase tracking-wider mb-1">‡∏≠‡∏∏‡∏ï‡∏∏‡∏™‡∏°‡∏∏‡∏è‡∏ê‡∏≤‡∏ô (‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)</div>
                                <h3 class="text-xl font-bold text-green-900" id="todaySeason">...</h3>
                                <div class="text-xs text-gray-600 mt-1"><i class="far fa-clock mr-1"></i> <span id="todayDate">...</span></div>
                            </div>
                            <div class="text-right">
                                <span class="block text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded-lg border border-red-100">
                                    <i class="fas fa-exclamation-circle mr-1"></i>‡∏£‡∏∞‡∏ß‡∏±‡∏á: <span id="todayVulnerable">...</span>
                                </span>
                            </div>
                        </div>
                        <div class="mt-3 text-xs text-gray-600 leading-relaxed relative z-10" id="todayHealth">...</div>
                        <i id="weatherIconBg" class="fas fa-sun weather-icon-lg"></i>
                    </div>
                </div>
            </div>

            <div id="resultFace" class="card-face card-back">
                <div id="backFx" class="fx-container" style="background:white;"></div>

                <div id="resultHeader" class="result-header">
                    <div class="avatar-frame">
                        <img id="avatarImg" src="" class="w-full h-full object-cover">
                    </div>
                    <h2 class="text-3xl font-bold text-white drop-shadow-md mt-2" id="resMain">...</h2>
                    <p class="text-white/90 text-sm font-light mt-1 bg-white/20 inline-block px-3 py-1 rounded-full backdrop-blur-sm" id="resSub">...</p>
                </div>

                <div class="back-content">
                    
                    <div class="section-header">
                        <i class="fas fa-user-astronaut"></i> ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏¥‡∏™‡∏±‡∏¢ <div class="section-line"></div>
                    </div>
                    <p class="text-[10px] text-gray-400 mb-2 pl-1">*‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</p>
                    <div id="traitChips" class="flex flex-wrap"></div>

                    <div class="section-header" style="color:#C62828;">
                        <i class="fas fa-heartbeat"></i> ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û <div class="section-line"></div>
                    </div>
                    <div id="healthChips" class="flex flex-wrap"></div>

                    <div class="section-header" style="color:#2E7D32;">
                        <i class="fas fa-seedling"></i> ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏î‡∏∏‡∏• <div class="section-line"></div>
                    </div>
                    
                    <div class="bg-green-50 rounded-xl p-4 border border-green-100 mb-4">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-8 h-8 rounded-full bg-green-200 flex items-center justify-center text-green-700"><i class="fas fa-thumbs-up"></i></div>
                            <div>
                                <div class="text-xs text-gray-500">‡∏£‡∏™‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏±‡∏ô</div>
                                <div id="resTasteGood" class="font-bold text-gray-800 text-sm"></div>
                            </div>
                        </div>
                        <div id="resTasteGoodReason" class="text-xs text-gray-600 pl-10 mb-3 border-l-2 border-green-200 ml-4"></div>
                        
                        <div class="h-px bg-gray-200 w-full my-2"></div>

                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-500"><i class="fas fa-ban"></i></div>
                            <div>
                                <div class="text-xs text-gray-500">‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á</div>
                                <div id="resTasteBad" class="font-bold text-gray-800 text-sm"></div>
                            </div>
                        </div>
                    </div>

                    <p class="text-xs font-bold text-gray-500 mb-2 ml-1">‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ)</p>
                    <div id="foodList" class="food-grid mb-4"></div>
                    
                    <p class="text-xs font-bold text-gray-500 mb-2 ml-1">‡∏ú‡∏•‡πÑ‡∏°‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</p>
                    <div id="fruitList" class="food-grid mb-6"></div>
                    
                    <div class="text-[10px] text-gray-300 text-center mt-4 mb-2" id="debugCalc"></div>
                </div>

                <div class="save-bar">
                    <button onclick="resetCard()" class="btn-reset"><i class="fas fa-undo"></i></button>
                    <button onclick="saveAndReset()" class="btn-save">
                        <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span> <i class="fas fa-check-circle text-green-400"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. CORE LOGIC & DATA (DO NOT TOUCH) ---
        // (‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ Logic ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyX7ZJvwflkNzhZ1SPPOJZZcJBvh_Bpbc2acOjh6fEcj58fv9wHu4i9M8J5BoCNmIoDbw/exec';
        let currentSessionId = "";
        let analysisMeta = {}; 
        let selectedTraits = new Set();
        let selectedHealth = new Set();

        const adhikamasaYears = [1947,1950,1953,1956,1958,1961,1964,1966,1969,1972,1975,1977,1980,1983,1986,1988,1991,1994,1997,1999,2002,2004,2007,2010,2012,2015,2018,2020,2023,2026,2029,2031,2034,2037,2040,2042,2045,2048,2051,2053,2056,2059,2062,2065,2068];
        const seasonData = { 
            summer: { name: "‡∏Ñ‡∏¥‡∏°‡∏´‡∏±‡∏ô‡∏ï‡∏§‡∏î‡∏π (‡∏£‡πâ‡∏≠‡∏ô)", vul: "‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü", health: "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏•‡∏°‡πÅ‡∏î‡∏î ‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô ‡∏Å‡∏£‡∏∞‡∏´‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", food: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡∏Ç‡∏° ‡πÄ‡∏¢‡πá‡∏ô ‡∏à‡∏∑‡∏î", theme: "summer", fx: "sun" }, 
            rain: { name: "‡∏ß‡∏™‡∏±‡∏ô‡∏ï‡∏§‡∏î‡∏π (‡∏ù‡∏ô)", vul: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏°/‡πÑ‡∏ü", health: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô ‡∏®‡∏µ‡∏£‡∏©‡∏∞", food: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß ‡πÄ‡∏ú‡πá‡∏î‡∏£‡πâ‡∏≠‡∏ô", theme: "rain", fx: "rain" }, 
            winter: { name: "‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡∏§‡∏î‡∏π (‡∏´‡∏ô‡∏≤‡∏ß)", vul: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥/‡∏î‡∏¥‡∏ô", health: "‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á ‡∏õ‡∏ß‡∏î‡∏Ç‡πâ‡∏≠ ‡∏ô‡πâ‡∏≥‡∏°‡∏π‡∏Å‡πÑ‡∏´‡∏•", food: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡∏°‡∏±‡∏ô ‡πÄ‡∏Ñ‡πá‡∏° ‡∏£‡πâ‡∏≠‡∏ô", theme: "winter", fx: "snow" } 
        };
        
        function getDailySeason(m) { if (m>=5 && m<=6) return seasonData.summer; if (m>=7 && m<=10) return seasonData.rain; return seasonData.winter; }
        
        function calculateRealLunarDate(date) {
            const knownNewMoon = new Date(2000, 0, 6, 18, 14, 0); const diffDays = (date.getTime() - knownNewMoon.getTime()) / (1000 * 3600 * 24);
            let moonAge = (diffDays % 29.53059) + 1.3; if (moonAge < 0) moonAge += 29.53059; if (moonAge > 29.53059) moonAge -= 29.53059;
            let lastNewMoon = new Date(date); lastNewMoon.setDate(date.getDate() - Math.floor(moonAge));
            let nmMonth = lastNewMoon.getMonth() + 1;
            const map = {12:1, 1:2, 2:3, 3:4, 4:5, 5:6, 6:7, 7:8, 8:9, 9:10, 10:11, 11:12};
            let thaiMonth = map[nmMonth];
            let phase = Math.floor(moonAge) + 1 <= 15 ? "Waxing" : "Waning";
            if (adhikamasaYears.includes(date.getFullYear()) && (nmMonth>=7 || nmMonth<=3)) { thaiMonth -= 1; if(thaiMonth<=0) thaiMonth=12; }
            const tNum = ["‡πê","‡πë","‡πí","‡πì","‡πî","‡πï","‡πñ","‡πó","‡πò","‡πô"];
            const toT = (n) => n.toString().split('').map(x=>tNum[x]||x).join('');
            const dStr = `${phase=='Waxing'?'‡∏Ç‡∏∂‡πâ‡∏ô':'‡πÅ‡∏£‡∏°'} ${toT(Math.floor(moonAge)+1 > 15 ? Math.floor(moonAge)+1-15 : Math.floor(moonAge)+1)} ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${toT(thaiMonth)}`;
            return { thaiMonth, phase, display: dStr };
        }

        const baseElementData = {
            earth: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô (‡∏õ‡∏ñ‡∏ß‡∏µ)",
                traits: ["‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏™‡∏π‡∏á‡πÉ‡∏´‡∏ç‡πà", "‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á", "‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡πÉ‡∏´‡∏ç‡πà", "‡∏ú‡∏°‡∏î‡∏Å‡∏î‡∏≥‡∏´‡∏ô‡∏≤", "‡∏û‡∏π‡∏î‡∏à‡∏≤‡∏â‡∏∞‡∏â‡∏≤‡∏ô", "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á", "‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏ô‡πà‡∏ô", "‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö", "‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á", "‡∏î‡∏∑‡πâ‡∏≠‡∏£‡∏±‡πâ‡∏ô"],
                recTaste: "‡∏ù‡∏≤‡∏î, ‡∏´‡∏ß‡∏≤‡∏ô, ‡∏°‡∏±‡∏ô, ‡πÄ‡∏Ñ‡πá‡∏°",
                recReason: "‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏™‡∏°‡∏≤‡∏ô‡πÅ‡∏ú‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (‡∏ù‡∏≤‡∏î) ‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á (‡∏´‡∏ß‡∏≤‡∏ô/‡∏°‡∏±‡∏ô/‡πÄ‡∏Ñ‡πá‡∏°)",
                badTaste: "‡∏°‡∏±‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ, ‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
                badReason: "‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏≤‡∏ú‡∏•‡∏≤‡∏ç‡∏¢‡∏≤‡∏Å ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô‡∏Å‡∏≥‡πÄ‡∏£‡∏¥‡∏ö (‡∏≠‡πâ‡∏ß‡∏ô/‡πÑ‡∏Ç‡∏°‡∏±‡∏ô)",
                foods: ["‡∏ú‡∏±‡∏Å‡∏Å‡∏π‡∏î", "‡πÅ‡∏Å‡∏á‡πÄ‡∏•‡∏µ‡∏¢‡∏á", "‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ", "‡∏°‡∏±‡∏™‡∏°‡∏±‡πà‡∏ô (‡∏û‡∏≠‡∏î‡∏µ)", "‡∏û‡∏∞‡πÇ‡∏•‡πâ", "‡∏£‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤", "‡∏¢‡∏≥‡∏ñ‡∏±‡πà‡∏ß‡∏û‡∏π"],
                fruits: ["‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î", "‡∏ù‡∏£‡∏±‡πà‡∏á‡∏î‡∏¥‡∏ö", "‡∏ü‡∏±‡∏Å‡∏ó‡∏≠‡∏á", "‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å", "‡∏ñ‡∏±‡πà‡∏ß‡∏ï‡πà‡∏≤‡∏á‡πÜ", "‡πÄ‡∏á‡∏≤‡∏∞", "‡∏ô‡πâ‡∏≥‡∏ô‡∏°", "‡∏≠‡πâ‡∏≠‡∏¢"]
            },
            fire: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü (‡πÄ‡∏ï‡πÇ‡∏ä)",
                traits: ["‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏™‡∏°‡∏™‡πà‡∏ß‡∏ô", "‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏ß‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á", "‡∏û‡∏π‡∏î‡∏ä‡∏±‡∏î", "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á", "‡∏´‡∏¥‡∏ß‡∏ö‡πà‡∏≠‡∏¢", "‡∏Å‡∏¥‡∏ô‡∏à‡∏∏", "‡∏Ç‡∏µ‡πâ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î", "‡πÇ‡∏Å‡∏£‡∏ò‡∏á‡πà‡∏≤‡∏¢‡∏´‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß", "‡∏ú‡∏°‡∏´‡∏á‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏¢"],
                recTaste: "‡∏Ç‡∏°, ‡πÄ‡∏¢‡πá‡∏ô, ‡∏à‡∏∑‡∏î",
                recReason: "‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô ‡∏î‡∏±‡∏ö‡∏û‡∏¥‡∏©‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢",
                badTaste: "‡∏£‡∏™‡∏à‡∏±‡∏î (‡πÄ‡∏ú‡πá‡∏î/‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß/‡πÄ‡∏Ñ‡πá‡∏°), ‡∏£‡πâ‡∏≠‡∏ô",
                badReason: "‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÄ‡∏£‡∏¥‡∏ö ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏Ç‡πâ ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î",
                foods: ["‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î‡∏ï‡∏≥‡∏•‡∏∂‡∏á", "‡∏ï‡πâ‡∏°‡∏ü‡∏±‡∏Å", "‡∏ú‡∏±‡∏î‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á", "‡πÅ‡∏ï‡∏á‡∏Å‡∏ß‡∏≤‡∏ú‡∏±‡∏î‡πÑ‡∏Ç‡πà", "‡πÅ‡∏Å‡∏á‡∏™‡πâ‡∏° (‡πÑ‡∏°‡πà‡πÄ‡∏ú‡πá‡∏î‡∏°‡∏≤‡∏Å)", "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏´‡∏ô‡∏∏‡πà‡∏°"],
                fruits: ["‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "‡πÅ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏•‡∏π‡∏õ", "‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏±‡∏á‡∏Å‡∏£", "‡∏ä‡∏°‡∏û‡∏π‡πà", "‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î", "‡∏™‡πâ‡∏°‡πÇ‡∏≠"]
            },
            wind: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏° (‡∏ß‡∏≤‡πÇ‡∏¢)",
                traits: ["‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ú‡∏≠‡∏°", "‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á", "‡∏ú‡∏°‡∏ö‡∏≤‡∏á", "‡∏û‡∏π‡∏î‡πÄ‡∏¢‡∏≠‡∏∞", "‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô", "‡∏Ç‡∏µ‡πâ‡∏Å‡∏•‡∏±‡∏ß", "‡∏ß‡∏¥‡∏ï‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏•", "‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏´‡πá‡∏ô", "‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å"],
                recTaste: "‡πÄ‡∏ú‡πá‡∏î‡∏£‡πâ‡∏≠‡∏ô, ‡∏™‡∏∏‡∏Ç‡∏∏‡∏°",
                recReason: "‡∏ä‡πà‡∏ß‡∏¢‡∏Ç‡∏±‡∏ö‡∏•‡∏° ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏•‡∏° ‡πÅ‡∏Å‡πâ‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏ü‡πâ‡∏≠",
                badTaste: "‡∏£‡∏™‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ, ‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏±‡∏Å‡∏î‡∏≠‡∏á",
                badReason: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏°‡∏´‡∏∞‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏Ç‡πâ‡∏ô ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏•‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å",
                foods: ["‡∏ï‡πâ‡∏°‡∏¢‡∏≥", "‡∏Ç‡πà‡∏≤‡πÑ‡∏Å‡πà", "‡πÅ‡∏Å‡∏á‡∏õ‡πà‡∏≤", "‡∏ú‡∏±‡∏î‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤", "‡πÑ‡∏Å‡πà‡∏ú‡∏±‡∏î‡∏Ç‡∏¥‡∏á", "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏Ç‡∏¥‡∏á"],
                fruits: ["‡∏™‡πâ‡∏°", "‡πÄ‡∏á‡∏≤‡∏∞", "‡∏™‡∏•‡∏∞", "‡∏•‡∏≠‡∏á‡∏Å‡∏≠‡∏á", "‡∏•‡∏≥‡πÑ‡∏¢", "‡∏ô‡πâ‡∏≥‡∏Ç‡∏¥‡∏á"]
            },
            water: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥ (‡∏≠‡∏≤‡πÇ‡∏õ)",
                traits: ["‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏≠‡∏ß‡∏ö", "‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏ß", "‡∏ï‡∏≤‡πÇ‡∏ï", "‡∏û‡∏π‡∏î‡∏ä‡πâ‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏û‡πÄ‡∏£‡∏≤‡∏∞", "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ä‡πâ‡∏≤", "‡∏ú‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ß‡∏¢", "‡∏ú‡∏°‡∏î‡∏Å‡∏î‡∏≥", "‡∏ä‡∏≠‡∏ö‡∏ô‡∏≠‡∏ô", "‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô"],
                recTaste: "‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß, ‡∏Ç‡∏°, ‡∏£‡πâ‡∏≠‡∏ô",
                recReason: "‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏±‡∏î‡πÄ‡∏™‡∏°‡∏´‡∏∞ (‡πÄ‡∏™‡∏°‡∏´‡∏∞) ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÇ‡∏•‡∏´‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô",
                badTaste: "‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î, ‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß‡∏à‡∏±‡∏î, ‡πÄ‡∏Ñ‡πá‡∏°‡∏à‡∏±‡∏î",
                badReason: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡∏°‡∏´‡∏∞ ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏ö‡∏ß‡∏°‡∏á‡πà‡∏≤‡∏¢",
                foods: ["‡πÅ‡∏Å‡∏á‡∏™‡πâ‡∏°‡∏î‡∏≠‡∏Å‡πÅ‡∏Ñ", "‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏õ‡∏•‡∏≤", "‡∏´‡πà‡∏≠‡∏´‡∏°‡∏Å", "‡πÅ‡∏Å‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á", "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏°‡∏∞‡∏Ç‡∏≤‡∏°", "‡∏™‡πâ‡∏°‡∏ï‡∏≥"],
                fruits: ["‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", "‡∏°‡∏∞‡πÄ‡∏ü‡∏∑‡∏≠‡∏á", "‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏°", "‡∏ï‡∏∞‡∏•‡∏¥‡∏á‡∏õ‡∏•‡∏¥‡∏á"]
            },
            fire_wind: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü‡∏£‡∏∞‡∏Ñ‡∏ô‡∏•‡∏° (‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠‡∏¢‡∏ï‡πà‡∏≠)",
                traits: ["‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô", "‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î‡∏á‡πà‡∏≤‡∏¢ (‡πÑ‡∏ü)", "‡∏Ç‡∏µ‡πâ‡∏Å‡∏±‡∏á‡∏ß‡∏• (‡∏•‡∏°)", "‡∏û‡∏π‡∏î‡πÄ‡∏£‡πá‡∏ß", "‡∏Ñ‡∏¥‡∏î‡πÄ‡∏£‡πá‡∏ß"],
                recTaste: "‡∏à‡∏∑‡∏î, ‡∏´‡∏≠‡∏°‡πÄ‡∏¢‡πá‡∏ô, ‡∏™‡∏∏‡∏Ç‡∏∏‡∏°",
                recReason: "‡∏î‡∏±‡∏ö‡∏û‡∏¥‡∏©‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏®‡∏µ‡∏£‡∏©‡∏∞",
                badTaste: "‡πÄ‡∏ú‡πá‡∏î‡∏à‡∏±‡∏î, ‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î",
                badReason: "‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏•‡∏°‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÄ‡∏£‡∏¥‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô",
                foods: ["‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î", "‡∏õ‡∏•‡∏≤‡∏ô‡∏∂‡πà‡∏á", "‡∏ú‡∏±‡∏î‡∏Ç‡∏¥‡∏á (‡∏≠‡πà‡∏≠‡∏ô‡πÜ)", "‡∏ô‡πâ‡∏≥‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏§‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏¢‡πá‡∏ô"],
                fruits: ["‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", "‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏±‡∏á‡∏Å‡∏£"]
            }
        };

        const sadaoData = [
            { check: (m, p) => (m==1 && p=='Waning') || (m==2 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πí", baseElement: "earth",  
              health: ["‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å", "‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢‡∏•‡∏≥‡∏ö‡∏≤‡∏Å", "‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á", "‡∏•‡∏°‡∏ï‡∏¥‡∏î‡πÉ‡∏ô‡πÄ‡∏™‡πâ‡∏ô"] },
            { check: (m, p) => (m==2 && p=='Waning') || (m==3 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πí - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πì", baseElement: "earth",  
              health: ["‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏î", "‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏≠‡∏¥‡πà‡∏°", "‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏á‡πà‡∏≤‡∏¢"] },
            { check: (m, p) => (m==3 && p=='Waning') || (m==4 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πì - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πî", baseElement: "earth",  
              health: ["‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏´‡∏•‡∏ß‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢", "‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô", "‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", "‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞"] },
            { check: (m, p) => (m==4 && p=='Waning') || (m==5 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πî - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πï", baseElement: "fire",  
              health: ["‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏°", "‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏∑‡∏î", "‡πÑ‡∏Ç‡πâ‡πÅ‡∏î‡∏î", "‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô", "‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å"] },
            { check: (m, p) => (m==5 && p=='Waning') || (m==6 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πï - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πñ", baseElement: "fire",  
              health: ["‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô", "‡∏Å‡∏£‡∏∞‡∏´‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô"] },
            { check: (m, p) => (m==6 && p=='Waning') || (m==7 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πñ - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πó", baseElement: "fire",  
              health: ["‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï", "‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô", "‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å", "‡∏ï‡∏∑‡πà‡∏ô‡∏á‡πà‡∏≤‡∏¢"] },
            { check: (m, p) => (m==8 && p=='Waning') || (m==9 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πò - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πô", baseElement: "fire_wind",  
              health: ["‡∏õ‡∏ß‡∏î‡∏®‡∏µ‡∏£‡∏©‡∏∞", "‡∏õ‡∏ß‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏ï‡∏≤", "‡∏´‡∏π‡∏≠‡∏∑‡πâ‡∏≠", "‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", "‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î", "‡πÅ‡∏ô‡πà‡∏ô‡∏ó‡πâ‡∏≠‡∏á"] },
            { check: (m, p) => (m==7 && p=='Waning') || (m==8 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πó - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πò", baseElement: "wind",  
              health: ["‡πÑ‡∏≠", "‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á‡∏Ñ‡∏≠", "‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏≠", "‡∏à‡∏∏‡∏Å‡∏Ñ‡∏≠", "‡∏•‡∏°‡∏ï‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô"] },
            { check: (m, p) => (m==9 && p=='Waning') || (m==10 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πô - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πê", baseElement: "wind",  
              health: ["‡∏Å‡∏£‡∏î‡πÑ‡∏´‡∏•‡∏¢‡πâ‡∏≠‡∏ô", "‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏ü‡πâ‡∏≠", "‡∏ó‡πâ‡∏≠‡∏á‡∏ö‡∏¥‡∏î", "‡πÅ‡∏™‡∏ö‡∏£‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏Å", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏¢‡πà‡∏≠‡∏¢"] },
            { check: (m, p) => (m==10 && p=='Waning') || (m==11 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πê - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πë", baseElement: "water",  
              health: ["‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏ß‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠", "‡∏õ‡∏ß‡∏î‡πÄ‡∏Ç‡πà‡∏≤", "‡∏õ‡∏ß‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å", "‡∏£‡∏¥‡∏î‡∏™‡∏µ‡∏î‡∏ß‡∏á", "‡∏ù‡∏µ", "‡∏™‡∏¥‡∏ß"] },
            { check: (m, p) => (m==11 && p=='Waning') || (m==12 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πë - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πí", baseElement: "water",  
              health: ["‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ", "‡∏´‡∏ß‡∏±‡∏î", "‡∏ô‡πâ‡∏≥‡∏°‡∏π‡∏Å", "‡∏Å‡∏£‡∏ô", "‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î", "‡πÅ‡∏ô‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å"] },
            { check: (m, p) => (m==12 && p=='Waning') || (m==1 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πí - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë", baseElement: "water",  
              health: ["‡∏ú‡∏î‡∏ú‡∏∑‡πà‡∏ô", "‡∏™‡∏¥‡∏ß", "‡∏•‡∏°‡∏û‡∏¥‡∏©", "‡∏Ñ‡∏±‡∏ô‡∏á‡πà‡∏≤‡∏¢", "‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á"] }
        ];

        // --- 2. NEW UI/UX FUNCTIONS ---

        // Particle System Renderer
        function renderEffects(type, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = ''; // Clear prev

            if (type === 'fire') {
                for(let i=0; i<15; i++) {
                    let p = document.createElement('div');
                    p.className = 'particle-ember';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.animationDuration = (2 + Math.random() * 3) + 's';
                    p.style.animationDelay = Math.random() + 's';
                    container.appendChild(p);
                }
            } else if (type === 'water') {
                for(let i=0; i<12; i++) {
                    let p = document.createElement('div');
                    p.className = 'particle-bubble';
                    let size = 10 + Math.random()*20;
                    p.style.width = size+'px'; p.style.height = size+'px';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.animationDuration = (4 + Math.random() * 4) + 's';
                    container.appendChild(p);
                }
            } else if (type === 'wind') {
                for(let i=0; i<6; i++) {
                    let p = document.createElement('div');
                    p.className = 'particle-cloud';
                    p.style.width = (100 + Math.random()*150) + 'px';
                    p.style.height = (20 + Math.random()*30) + 'px';
                    p.style.top = Math.random() * 80 + '%';
                    p.style.animationDuration = (3 + Math.random() * 3) + 's';
                    container.appendChild(p);
                }
            } else if (type === 'earth') {
                for(let i=0; i<10; i++) {
                    let p = document.createElement('div');
                    p.className = 'particle-leaf';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.animationDuration = (5 + Math.random() * 5) + 's';
                    p.style.background = Math.random() > 0.5 ? '#81C784' : '#A1887F';
                    container.appendChild(p);
                }
            } else if (type === 'sun') {
                let s = document.createElement('div');
                s.className = 'particle-sun';
                container.appendChild(s);
            } else if (type === 'rain') {
                for(let i=0; i<30; i++) {
                    let p = document.createElement('div');
                    p.className = 'particle-rain';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.animationDuration = (0.5 + Math.random() * 0.5) + 's';
                    container.appendChild(p);
                }
            } else if (type === 'snow') {
                // Reusing Ember but white
                for(let i=0; i<20; i++) {
                    let p = document.createElement('div');
                    p.className = 'particle-ember';
                    p.style.background = 'white';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.top = '-10px';
                    p.style.animationName = 'fallDown'; // Fall instead of rise
                    p.style.animationDuration = (4 + Math.random() * 4) + 's';
                    container.appendChild(p);
                }
            }
        }

        window.onload = function() {
            currentSessionId = 'u' + Date.now() + 'r' + Math.floor(Math.random()*1000);
            
            const dS = document.getElementById('inputDay'); for(let i=1; i<=31; i++) { let o = document.createElement('option'); o.value=i; o.innerText=i; dS.appendChild(o); }
            const mS = document.getElementById('inputMonth'); const months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"]; months.forEach((m,i)=>{ let o=document.createElement('option'); o.value=i+1; o.innerText=m; mS.appendChild(o); });
            const yS = document.getElementById('inputYear'); const curY = new Date().getFullYear(); for(let i=0; i<100; i++) { let y = curY-i; let o = document.createElement('option'); o.value = y; o.innerText = y+543; yS.appendChild(o); } yS.value = curY-30;
            
            updateDailyForecast();
        }

        function updateDailyForecast() {
            const today = new Date(); 
            const lunar = calculateRealLunarDate(today); 
            let checkM = lunar.thaiMonth; if(checkM==88) checkM=8;
            const season = getDailySeason(checkM);
            const mTh = ["‡∏°.‡∏Ñ.","‡∏Å.‡∏û.","‡∏°‡∏µ.‡∏Ñ.","‡πÄ‡∏°.‡∏¢.","‡∏û.‡∏Ñ.","‡∏°‡∏¥.‡∏¢.","‡∏Å.‡∏Ñ.","‡∏™.‡∏Ñ.","‡∏Å.‡∏¢.","‡∏ï.‡∏Ñ.","‡∏û.‡∏¢.","‡∏ò.‡∏Ñ."];
            
            document.getElementById('todayDate').innerText = `${today.getDate()} ${mTh[today.getMonth()]} ${today.getFullYear()+543}`;
            document.getElementById('todaySeason').innerText = season.name;
            document.getElementById('todayVulnerable').innerText = season.vul;
            document.getElementById('todayHealth').innerText = season.health;
            
            // Icon Mapping
            const iconEl = document.getElementById('weatherIconBg');
            if(season.fx == 'sun') iconEl.className = 'fas fa-sun weather-icon-lg text-yellow-500';
            else if(season.fx == 'rain') iconEl.className = 'fas fa-cloud-showers-heavy weather-icon-lg text-blue-500';
            else iconEl.className = 'fas fa-snowflake weather-icon-lg text-blue-200';

            // Trigger "Uttu" Effects
            renderEffects(season.fx, 'frontFx');
        }

        function createChips(items, containerId, selectionSet) {
            const c = document.getElementById(containerId); c.innerHTML = '';
            items.forEach(item => {
                const chip = document.createElement('div');
                chip.className = 'chip'; 
                chip.innerHTML = `<i class="fas fa-check-circle mr-1 hidden"></i> ${item}`;
                chip.onclick = function() {
                    this.classList.toggle('selected');
                    if(this.classList.contains('selected')) selectionSet.add(item);
                    else selectionSet.delete(item);
                };
                c.appendChild(chip);
            });
        }

        function createFoodTags(items, id) {
            const c = document.getElementById(id); c.innerHTML='';
            items.forEach(i => {
                let a = document.createElement('a'); a.className='food-item';
                a.innerHTML = `<div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-lg mb-1">ü•ò</div><span>${i}</span>`;
                a.href = `https://www.google.com/search?tbm=isch&q=${i} ‡∏≠‡∏≤‡∏´‡∏≤‡∏£`; a.target = '_blank'; c.appendChild(a);
            });
        }

        function logToGoogleSheet(data) {
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST', mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).catch(e => console.error("Log Error:", e));
        }

        async function startAnalysis() {
            document.getElementById('loading').style.display = 'flex';
            
            setTimeout(async () => {
                const d = parseInt(document.getElementById('inputDay').value);
                const m = parseInt(document.getElementById('inputMonth').value);
                const y = parseInt(document.getElementById('inputYear').value);
                let birthDate = new Date(y, m-1, d);
                let conceptionDate = new Date(birthDate); conceptionDate.setMonth(birthDate.getMonth()-9);
                const lunar = calculateRealLunarDate(conceptionDate);
                
                if (!lunar) { alert("‡∏õ‡∏µ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö"); document.getElementById('loading').style.display = 'none'; return; }

                let checkMonth = lunar.thaiMonth; if (checkMonth == 88) checkMonth = 8;
                let key = "earth"; let specificHealthArr = []; let range = ""; let matched = false;

                for (let rule of sadaoData) {
                    if (rule.check(checkMonth, lunar.phase)) {
                        key = rule.baseElement; specificHealthArr = rule.health; range = rule.range; matched = true; break;
                    }
                }
                
                if(!matched) {
                    if(checkMonth >= 1 && checkMonth <= 4) { key="earth"; specificHealthArr=["‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å"]; }
                    else if(checkMonth >= 5 && checkMonth <= 7) { key="fire"; specificHealthArr=["‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô"]; }
                    else if(checkMonth >= 8 && checkMonth <= 10) { key="wind"; specificHealthArr=["‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î"]; }
                    else { key="water"; specificHealthArr=["‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ"]; }
                }

                const data = baseElementData[key];
                selectedTraits.clear(); selectedHealth.clear();
                
                analysisMeta = {
                    sessionId: currentSessionId, birthDate: `${d}/${m}/${y+543}`, element: data.name, conceptionDate: lunar.display
                };

                let color="", avatar="", fxType="";
                // Setup Themes
                if(key.includes("fire")) { 
                    color="linear-gradient(135deg, #FF9966, #FF5E62)"; 
                    avatar="https://img5.pic.in.th/file/secure-sv1/41a8f63dde1ba7c4b.png"; 
                    fxType = "fire";
                }
                else if(key.includes("wind")) { 
                    color="linear-gradient(135deg, #56ab2f, #a8e063)"; 
                    avatar="https://img2.pic.in.th/261c90e765ec6b116.png"; 
                    fxType = "wind";
                }
                else if(key.includes("water")) { 
                    color="linear-gradient(135deg, #36D1DC, #5B86E5)"; 
                    avatar="https://img5.pic.in.th/file/secure-sv1/3141eb0166e3e7f51.png"; 
                    fxType = "water";
                }
                else { // Earth
                    color="linear-gradient(135deg, #CAC531, #F3F9A7)"; 
                    avatar="https://img2.pic.in.th/1c8b450894dd6fe8e.png"; 
                    fxType = "earth";
                }

                document.getElementById('resMain').innerText = data.name;
                document.getElementById('resSub').innerText = range; 
                document.getElementById('debugCalc').innerText = `Ref: ‡∏õ‡∏è‡∏¥‡∏™‡∏ô‡∏ò‡∏¥ ${lunar.display}`;
                document.getElementById('avatarImg').src = avatar;
                document.getElementById('resultHeader').style.background = color;

                createChips(data.traits, 'traitChips', selectedTraits);
                createChips(specificHealthArr, 'healthChips', selectedHealth);

                document.getElementById('resTasteGood').innerText = data.recTaste;
                document.getElementById('resTasteGoodReason').innerText = data.recReason;
                document.getElementById('resTasteBad').innerText = `${data.badTaste} (${data.badReason})`;
                
                createFoodTags(data.foods, 'foodList');
                createFoodTags(data.fruits, 'fruitList');

                // Trigger "Element" Effects
                renderEffects(fxType, 'backFx');

                document.getElementById('cardObject').classList.add('is-flipped');
                document.getElementById('loading').style.display = 'none';

                logToGoogleSheet({
                      type: 'analysis',
                      sessionId: currentSessionId,
                      timestamp: new Date().toISOString(),
                      ...analysisMeta
                });
            }, 800); // Increased delay slightly for dramatic effect
        }

        async function saveAndReset() {
            document.getElementById('loading').style.display = 'flex';
            const payload = {
                ...analysisMeta,
                type: 'feedback',
                selectedTraits: Array.from(selectedTraits).join(", "),
                selectedHealth: Array.from(selectedHealth).join(", "),
                timestamp: new Date().toISOString()
            };
            logToGoogleSheet(payload);
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('cardObject').classList.remove('is-flipped');
                currentSessionId = 'u' + Date.now();
                // Simple toast or alert
                const btn = document.querySelector('.btn-save');
                const originText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß';
                setTimeout(()=> btn.innerHTML = originText, 2000);
            }, 800);
        }
        
        function resetCard() { document.getElementById('cardObject').classList.remove('is-flipped'); }
    </script>
</body>
</html>
