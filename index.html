<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô - ‡∏£‡∏û.‡∏™‡∏∞‡πÄ‡∏î‡∏≤</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary-gold: #D4AF37; --deep-green: #1B4D3E; }
        body { font-family: 'Prompt', sans-serif; background: #fdfbf7; overflow-x: hidden; perspective: 1000px; }
        
        .thai-bg {
            background-image: radial-gradient(#1B4D3E 1px, transparent 1px), radial-gradient(#D4AF37 1px, transparent 1px);
            background-size: 20px 20px; background-position: 0 0, 10px 10px; opacity: 0.05; position: absolute; inset: 0; z-index: -1;
        }

        /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏õ‡πá‡∏ô 600px ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏¢‡∏≠‡∏∞ */
        .card-scene { width: 100%; height: 600px; position: relative; perspective: 1000px; }
        
        .card-object { width: 100%; height: 100%; position: absolute; transform-style: preserve-3d; transition: transform 1.2s cubic-bezier(0.4, 0.2, 0.2, 1); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 24px; overflow: hidden; box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.1); }
        .card-front { background: rgba(255, 255, 255, 0.98); border: 1px solid rgba(212, 175, 55, 0.2); transform: rotateY(0deg); }
        .card-back { background: white; transform: rotateY(180deg); overflow-y: auto; }
        
        .is-flipped { transform: rotateY(180deg); }
        
        .custom-select { appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%231B4D3E' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 0.75rem center; background-repeat: no-repeat; background-size: 1.2em 1.2em; }
        
        .floating-icon { animation: float 3s ease-in-out infinite; }
        @keyframes float { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-8px) rotate(5deg); } 100% { transform: translateY(0px) rotate(0deg); } }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">
    
    <div class="thai-bg"></div>

    <div class="text-center mb-4 z-10">
        <div class="inline-block p-3 rounded-full bg-white shadow-md border border-green-100 mb-2">
            <i class="fas fa-spa text-3xl text-green-700"></i>
        </div>
        <h1 class="text-xl font-bold text-green-900">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</h1>
        <p class="text-yellow-700 text-xs">‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢ ‡∏£‡∏û.‡∏™‡∏∞‡πÄ‡∏î‡∏≤</p>
    </div>

    <div class="card-scene w-full max-w-sm">
        <div id="cardObject" class="card-object">
            
            <div class="card-face card-front p-6 flex flex-col justify-between">
                <div>
                    <div class="text-center mb-6">
                        <h2 class="text-green-800 font-bold text-lg">‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
                        <div class="h-1 w-16 bg-yellow-400 mx-auto mt-2 rounded-full"></div>
                    </div>
                    <div class="space-y-4">
                        <div class="relative">
                            <label class="absolute -top-2 left-3 bg-white px-1 text-xs text-green-600 font-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                            <select id="inputDay" class="custom-select w-full p-3 bg-green-50 border border-green-200 rounded-xl text-green-900 outline-none focus:ring-2 focus:ring-green-500"></select>
                        </div>
                        <div class="relative">
                            <label class="absolute -top-2 left-3 bg-white px-1 text-xs text-green-600 font-bold">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
                            <select id="inputMonth" class="custom-select w-full p-3 bg-green-50 border border-green-200 rounded-xl text-green-900 outline-none focus:ring-2 focus:ring-green-500">
                                <option value="1">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                                <option value="2">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                                <option value="3">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                                <option value="4">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                                <option value="5">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                                <option value="6">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                                <option value="7">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                                <option value="8">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                                <option value="9">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                                <option value="10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                                <option value="11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                                <option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                            </select>
                        </div>
                        <div class="relative">
                            <label class="absolute -top-2 left-3 bg-white px-1 text-xs text-green-600 font-bold">‡∏õ‡∏µ ‡∏û.‡∏®.</label>
                            <select id="inputYear" class="custom-select w-full p-3 bg-green-50 border border-green-200 rounded-xl text-green-900 outline-none focus:ring-2 focus:ring-green-500"></select>
                        </div>
                    </div>
                </div>
                <button onclick="startAnalysis()" class="w-full bg-gradient-to-r from-green-700 to-green-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition-all flex justify-center items-center gap-2 mb-2">
                    <span>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏ (3D Scan)</span> <i class="fas fa-fingerprint"></i>
                </button>
            </div>

            <div id="resultFace" class="card-face card-back">
                <div id="resultHeader" class="h-32 bg-gray-200 p-4 text-white flex flex-col items-center justify-center relative transition-all duration-700">
                    <div class="floating-icon text-5xl drop-shadow-lg mb-1" id="resIcon">?</div>
                    <h2 class="text-3xl font-bold drop-shadow-md" id="resMain">...</h2>
                    <span class="text-xs bg-white/20 px-3 py-1 rounded-full backdrop-blur-sm mt-1" id="resSub">...</span>
                </div>

                <div class="p-5 pb-20 space-y-4">
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                        <h3 class="text-green-800 font-bold text-sm mb-2"><i class="fas fa-stethoscope text-green-600 mr-2"></i>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô</h3>
                        <p id="resDesc" class="text-gray-600 text-sm leading-relaxed"></p>
                    </div>
                    <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                        <h3 class="text-red-800 font-bold text-sm mb-2"><i class="fas fa-ban text-red-500 mr-2"></i>‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á</h3>
                        <p id="resAvoid" class="text-gray-600 text-sm leading-relaxed"></p>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100">
                            <h4 class="font-bold text-green-800 text-xs mb-1"><i class="fas fa-utensils mr-1"></i>‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h4>
                            <p id="resFood" class="text-xs text-gray-500"></p>
                        </div>
                        <div class="bg-yellow-50 p-3 rounded-xl border border-yellow-100">
                            <h4 class="font-bold text-yellow-800 text-xs mb-1"><i class="fas fa-mortar-pestle mr-1"></i>‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£</h4>
                            <p id="resHerb" class="text-xs text-gray-500"></p>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                        <h3 class="text-blue-800 font-bold text-sm mb-2"><i class="fas fa-walking text-blue-500 mr-2"></i>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏£‡∏±‡∏ö‡∏ò‡∏≤‡∏ï‡∏∏</h3>
                        <p id="resActivity" class="text-gray-600 text-sm leading-relaxed"></p>
                    </div>
                </div>

                <div class="absolute bottom-0 left-0 w-full p-3 bg-white/90 backdrop-blur border-t z-10">
                    <button onclick="resetCard()" class="w-full py-2 bg-gray-100 rounded-lg text-gray-500 text-sm font-bold hover:bg-gray-200 transition">
                        <i class="fas fa-redo mr-1"></i> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyX7ZJvwflkNzhZ1SPPOJZZcJBvh_Bpbc2acOjh6fEcj58fv9wHu4i9M8J5BoCNmIoDbw/exec';

        // 1. Initial Setup
        window.onload = function() {
            const daySelect = document.getElementById('inputDay');
            for(let i=1; i<=31; i++) {
                let opt = document.createElement('option');
                opt.value = i; opt.innerHTML = i;
                daySelect.appendChild(opt);
            }
            const yearSelect = document.getElementById('inputYear');
            const currentYearBE = new Date().getFullYear() + 543;
            for(let i=0; i<100; i++) {
                let y = currentYearBE - i;
                let opt = document.createElement('option');
                opt.value = y - 543; opt.innerHTML = y;
                yearSelect.appendChild(opt);
            }
            yearSelect.value = (currentYearBE - 30 - 543);
        }

        // 2. Logic ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏≤‡∏ï‡∏∏ (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Activity ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏±‡∏ô)
        const elementData = [
            // ‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå) - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß
            { start: [12, 16], end: [1, 15], main: "‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå)", sub: "‡πÄ‡∏™‡∏°‡∏´‡∏∞‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏•‡∏≤‡∏¢", icon: "üíß", color: "from-blue-400 to-cyan-500", desc: "‡∏Ç‡∏µ‡πâ‡∏´‡∏ô‡∏≤‡∏ß ‡πÄ‡∏¢‡πá‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡∏≠‡∏õ‡∏•‡∏≤‡∏¢‡πÄ‡∏ó‡πâ‡∏≤", avoid: "‡∏ô‡πâ‡∏≥‡πÄ‡∏¢‡πá‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏§‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏¢‡πá‡∏ô", food: "‡∏ô‡πâ‡∏≥‡∏Ç‡∏¥‡∏á, ‡πÅ‡∏Å‡∏á‡∏õ‡πà‡∏≤", herb: "‡∏î‡∏µ‡∏õ‡∏•‡∏µ, ‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢", activity: "‡πÅ‡∏ä‡πà‡πÄ‡∏ó‡πâ‡∏≤‡πÉ‡∏ô‡∏ô‡πâ‡∏≥‡∏≠‡∏∏‡πà‡∏ô, ‡∏™‡∏ß‡∏°‡∏ñ‡∏∏‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô" },
            { start: [1, 16], end: [2, 15], main: "‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏Ñ‡∏π‡∏ñ‡πÄ‡∏™‡∏°‡∏´‡∏∞ (‡∏ï‡πâ‡∏ô)", icon: "üíß", color: "from-blue-400 to-cyan-500", desc: "‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î ‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏ü‡πâ‡∏≠ ‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢‡∏¢‡∏≤‡∏Å", avoid: "‡πÅ‡∏õ‡πâ‡∏á‡∏Ç‡∏±‡∏î‡∏Ç‡∏≤‡∏ß ‡∏ô‡∏°‡∏ß‡∏±‡∏ß", food: "‡∏™‡πâ‡∏°‡πÇ‡∏≠, ‡∏°‡∏∞‡∏•‡∏∞‡∏Å‡∏≠, ‡πÄ‡∏°‡πá‡∏î‡πÅ‡∏°‡∏á‡∏•‡∏±‡∏Å", herb: "‡∏™‡∏°‡∏≠‡πÑ‡∏ó‡∏¢, ‡∏ä‡∏∏‡∏°‡πÄ‡∏´‡πá‡∏î‡πÄ‡∏ó‡∏®", activity: "‡∏ô‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏Ç‡πá‡∏°‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤, ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏≠‡∏∏‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤" },
            
            // ‡πÑ‡∏ü (‡∏Ñ‡∏¥‡∏°‡∏´‡∏±‡∏ô‡∏ï‡πå)
            { start: [2, 16], end: [3, 15], main: "‡πÑ‡∏ü (‡∏Ñ‡∏¥‡∏°‡∏´‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏û‡∏±‡∏ó‡∏ò‡∏õ‡∏¥‡∏ï‡∏ï‡∏∞", icon: "üî•", color: "from-orange-400 to-red-500", desc: "‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î‡∏á‡πà‡∏≤‡∏¢ ‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å", avoid: "‡∏Ç‡∏≠‡∏á‡∏ó‡∏≠‡∏î ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡∏à‡∏±‡∏î ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î", food: "‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î‡∏ï‡∏≥‡∏•‡∏∂‡∏á, ‡∏°‡∏∞‡∏£‡∏∞", herb: "‡∏ü‡πâ‡∏≤‡∏ó‡∏∞‡∏•‡∏≤‡∏¢‡πÇ‡∏à‡∏£", activity: "‡∏ô‡∏±‡πà‡∏á‡∏™‡∏°‡∏≤‡∏ò‡∏¥, ‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥, ‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á" },
            { start: [3, 16], end: [4, 15], main: "‡πÑ‡∏ü (‡∏Ñ‡∏¥‡∏°‡∏´‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏≠‡∏û‡∏±‡∏ó‡∏ò‡∏õ‡∏¥‡∏ï‡∏ï‡∏∞", icon: "üî•", color: "from-orange-400 to-red-500", desc: "‡∏à‡∏∏‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏î ‡∏Å‡∏£‡∏î‡πÑ‡∏´‡∏•‡∏¢‡πâ‡∏≠‡∏ô", avoid: "‡∏Å‡∏¥‡∏ô‡∏î‡∏∂‡∏Å ‡∏Å‡∏≤‡πÅ‡∏ü ‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå", food: "‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á, ‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß", herb: "‡∏Ç‡∏°‡∏¥‡πâ‡∏ô‡∏ä‡∏±‡∏ô, ‡∏ß‡πà‡∏≤‡∏ô‡∏´‡∏≤‡∏á‡∏à‡∏£‡∏∞‡πÄ‡∏Ç‡πâ", activity: "‡πÄ‡∏î‡∏¥‡∏ô‡πÅ‡∏Å‡∏ß‡πà‡∏á‡πÅ‡∏Ç‡∏ô‡πÄ‡∏ö‡∏≤‡πÜ ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£" },
            { start: [4, 16], end: [5, 15], main: "‡πÑ‡∏ü (‡∏Ñ‡∏¥‡∏°‡∏´‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏Å‡∏≥‡πÄ‡∏î‡∏≤", icon: "üî•", color: "from-orange-400 to-red-500", desc: "‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏Ç‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏û‡πâ‡πÅ‡∏î‡∏î ‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß", avoid: "‡πÅ‡∏î‡∏î‡∏à‡∏±‡∏î ‡∏≠‡∏î‡∏ô‡∏≠‡∏ô", food: "‡∏ü‡∏±‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡πÅ‡∏ï‡∏á‡πÇ‡∏°", herb: "‡πÉ‡∏ö‡∏ö‡∏±‡∏ß‡∏ö‡∏Å, ‡∏£‡∏≤‡∏á‡∏à‡∏∑‡∏î", activity: "‡∏õ‡∏£‡∏∞‡∏Ñ‡∏ö‡πÄ‡∏¢‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏≤‡∏Å, ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏™‡∏≤‡∏¢‡∏ï‡∏≤" },
            
            // ‡∏•‡∏° (‡∏ß‡∏™‡∏±‡∏ô‡∏ï‡πå)
            { start: [5, 16], end: [6, 15], main: "‡∏•‡∏° (‡∏ß‡∏™‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏´‡∏ó‡∏±‡∏¢‡∏ß‡∏≤‡∏ï‡∏∞", icon: "üå¨Ô∏è", color: "from-green-400 to-emerald-600", desc: "‡πÉ‡∏à‡∏™‡∏±‡πà‡∏ô ‡∏ß‡∏¥‡∏ï‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏• ‡∏ô‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏•‡∏±‡∏ö", avoid: "‡∏Ç‡πà‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡∏ä‡∏≤/‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô", food: "‡∏Ç‡∏¥‡∏á, ‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤, ‡πÇ‡∏´‡∏£‡∏∞‡∏û‡∏≤", herb: "‡∏¢‡∏≤‡∏´‡∏≠‡∏°, ‡∏î‡∏≠‡∏Å‡∏°‡∏∞‡∏•‡∏¥", activity: "‡∏™‡∏ß‡∏î‡∏°‡∏ô‡∏ï‡πå, ‡∏î‡∏°‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏´‡∏≠‡∏° (Aroma)" },
            { start: [6, 16], end: [7, 15], main: "‡∏•‡∏° (‡∏ß‡∏™‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏™‡∏±‡∏ï‡∏ñ‡∏Å‡∏ß‡∏≤‡∏ï‡∏∞", icon: "üå¨Ô∏è", color: "from-green-400 to-emerald-600", desc: "‡∏õ‡∏ß‡∏î‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡πÅ‡∏ó‡∏á", avoid: "‡∏¢‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏±‡∏Å ‡πÅ‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πà‡∏≤‡∏ï‡∏±‡∏ß", food: "‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢, ‡∏î‡∏µ‡∏õ‡∏•‡∏µ", herb: "‡πÑ‡∏û‡∏•, ‡πÄ‡∏ñ‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏á", activity: "‡∏ô‡∏ß‡∏î‡∏õ‡∏£‡∏∞‡∏Ñ‡∏ö‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£, ‡∏¢‡∏∑‡∏î‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î (Yoga)" },
            { start: [7, 16], end: [8, 15], main: "‡∏•‡∏° (‡∏ß‡∏™‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏™‡∏∏‡∏°‡∏ô‡∏≤‡∏ß‡∏≤‡∏ï‡∏∞", icon: "üå¨Ô∏è", color: "from-green-400 to-emerald-600", desc: "‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏∑‡∏î ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô ‡∏°‡∏∑‡∏≠‡πÄ‡∏ó‡πâ‡∏≤‡∏ä‡∏≤", avoid: "‡∏•‡∏∏‡∏Å‡∏ô‡∏±‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏™‡∏π‡∏á", food: "‡∏ï‡πâ‡∏°‡∏Ç‡πà‡∏≤‡πÑ‡∏Å‡πà, ‡∏Ç‡∏¥‡∏á‡∏ú‡∏±‡∏î", herb: "‡∏Ç‡∏¥‡∏á‡πÅ‡∏Å‡πà, ‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢‡∏î‡∏≥", activity: "‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß, ‡∏ô‡∏ß‡∏î‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏ù‡πà‡∏≤‡πÄ‡∏ó‡πâ‡∏≤" },
            
            // ‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå) ‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏õ‡∏µ
            { start: [8, 16], end: [9, 15], main: "‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏®‡∏≠‡πÄ‡∏™‡∏°‡∏´‡∏∞", icon: "üíß", color: "from-blue-400 to-cyan-500", desc: "‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏≠‡∏ö‡πà‡∏≠‡∏¢ ‡πÑ‡∏≠ ‡∏°‡∏µ‡πÄ‡∏™‡∏°‡∏´‡∏∞", avoid: "‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô", food: "‡∏°‡∏∞‡∏ô‡∏≤‡∏ß, ‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏°", herb: "‡∏°‡∏∞‡πÅ‡∏ß‡πâ‡∏á, ‡∏ü‡πâ‡∏≤‡∏ó‡∏∞‡∏•‡∏≤‡∏¢‡πÇ‡∏à‡∏£", activity: "‡∏à‡∏¥‡∏ö‡∏ô‡πâ‡∏≥‡∏≠‡∏∏‡πà‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡πÜ, ‡∏Å‡∏•‡∏±‡πâ‡∏ß‡∏Ñ‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥‡πÄ‡∏Å‡∏•‡∏∑‡∏≠" },
            { start: [9, 16], end: [10, 15], main: "‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏≠‡∏∏‡∏£‡∏∞‡πÄ‡∏™‡∏°‡∏´‡∏∞", icon: "üíß", color: "from-blue-400 to-cyan-500", desc: "‡∏´‡∏≠‡∏ö‡∏´‡∏∑‡∏î ‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡πÅ‡∏ô‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å", avoid: "‡∏ù‡∏∏‡πà‡∏ô‡∏Ñ‡∏ß‡∏±‡∏ô ‡∏Ç‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå", food: "‡∏´‡∏≠‡∏°‡πÅ‡∏î‡∏á, ‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏°", herb: "‡∏´‡∏ô‡∏∏‡∏°‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏Å‡∏≤‡∏¢", activity: "‡∏ù‡∏∂‡∏Å‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏•‡∏∂‡∏Å‡πÜ, ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô" },
            { start: [10, 16], end: [11, 15], main: "‡∏ô‡πâ‡∏≥ (‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡πå)", sub: "‡∏Ñ‡∏π‡∏ñ‡πÄ‡∏™‡∏°‡∏´‡∏∞", icon: "üíß", color: "from-blue-400 to-cyan-500", desc: "‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å‡∏™‡∏•‡∏±‡∏ö‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ ‡∏ñ‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏î", avoid: "‡∏Å‡∏∞‡∏ó‡∏¥ ‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î", food: "‡πÄ‡∏°‡πá‡∏î‡πÅ‡∏°‡∏á‡∏•‡∏±‡∏Å, ‡∏™‡πâ‡∏°‡πÇ‡∏≠", herb: "‡∏™‡∏°‡∏≠‡πÑ‡∏ó‡∏¢, ‡∏ï‡∏£‡∏µ‡∏ú‡∏•‡∏≤", activity: "‡∏ô‡∏ß‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á, ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏∑‡πà‡∏ô‡∏ô‡∏≠‡∏ô" },
            { start: [11, 16], end: [12, 15], main: "‡∏î‡∏¥‡∏ô (‡∏£‡∏≠‡∏¢‡∏ï‡πà‡∏≠)", sub: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏´‡∏ô‡∏±‡∏Å", icon: "‚õ∞Ô∏è", color: "from-yellow-600 to-brown-500", desc: "‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å ‡∏≠‡∏∑‡∏î‡∏≠‡∏≤‡∏î ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏î‡∏∏‡∏•", avoid: "‡∏ô‡∏≠‡∏ô‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ", food: "‡∏ú‡∏±‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏™‡∏ù‡∏≤‡∏î", herb: "‡∏¢‡∏≤‡∏´‡∏≠‡∏°, ‡∏ï‡∏£‡∏µ‡∏ú‡∏•‡∏≤", activity: "‡πÄ‡∏î‡∏¥‡∏ô‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏¢‡∏≤‡∏°‡πÄ‡∏ä‡πâ‡∏≤" }
        ];

        // 3. Logic ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ (Check Date Range)
        function checkDate(d, m, startM, startD, endM, endD) {
            // ‡∏Å‡∏£‡∏ì‡∏µ‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÑ‡∏°‡πà‡∏Ç‡πâ‡∏≤‡∏°‡∏õ‡∏µ)
            if (startM < endM) {
                if (m === startM && d >= startD) return true;
                if (m === endM && d <= endD) return true;
                return false;
            } 
            // ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡πâ‡∏≤‡∏°‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ò.‡∏Ñ. - ‡∏°.‡∏Ñ.)
            else {
                if (m === startM && d >= startD) return true;
                if (m === endM && d <= endD) return true;
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏•‡∏≤‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡∏ä‡πà‡∏ß‡∏á‡∏¢‡∏≤‡∏ß)
                if (m > startM || m < endM) return true; 
                return false;
            }
        }

        function getElement(d, m) {
            for(let rule of elementData) {
                if (checkDate(d, m, rule.start[0], rule.start[1], rule.end[0], rule.end[1])) {
                    return rule;
                }
            }
            // Fallback (‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ)
            return elementData[0];
        }

        async function startAnalysis() {
            const d = parseInt(document.getElementById('inputDay').value);
            const m = parseInt(document.getElementById('inputMonth').value);
            const y = parseInt(document.getElementById('inputYear').value);
            const birthDateStr = `${y}-${String(m).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (‡πÉ‡∏ä‡πâ Logic ‡πÉ‡∏´‡∏°‡πà)
            const result = getElement(d, m);

            // Update UI
            document.getElementById('resMain').innerText = result.main;
            document.getElementById('resSub').innerText = result.sub;
            document.getElementById('resIcon').innerText = result.icon;
            document.getElementById('resDesc').innerText = result.desc;
            document.getElementById('resAvoid').innerText = result.avoid;
            document.getElementById('resFood').innerText = result.food;
            document.getElementById('resHerb').innerText = result.herb;
            
            // ‚úÖ ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏´‡∏° ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏Ç‡∏µ‡∏î‡∏•‡∏∞
            document.getElementById('resActivity').innerText = result.activity || "-"; 

            const header = document.getElementById('resultHeader');
            header.className = `h-32 bg-gradient-to-br ${result.color} p-4 text-white flex flex-col items-center justify-center relative overflow-hidden transition-all duration-1000`;

            const card = document.getElementById('cardObject');
            card.classList.add('is-flipped');
            
            try {
                fetch(SCRIPT_URL, {
                    method: 'POST', mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId: "Guest", birthDate: birthDateStr, element: result.main, subElement: result.sub })
                });
            } catch(e) {}
        }

        function resetCard() {
            document.getElementById('cardObject').classList.remove('is-flipped');
        }
    </script>
</body>
</html>
