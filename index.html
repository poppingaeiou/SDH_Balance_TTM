<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô (Sadao Official V3.0)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sarabun:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --gold-main: #D4AF37; --gold-light: #F9E79F; --green-deep: #1B4D3E; --bg-pattern: #FDFBF7; }
        body { font-family: 'Prompt', sans-serif; background-color: var(--bg-pattern); background-image: radial-gradient(#D4AF37 0.5px, transparent 0.5px), radial-gradient(#1B4D3E 0.5px, transparent 0.5px); background-size: 20px 20px; color: #333; overflow-x: hidden; }
        
        #loading { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; backdrop-filter: blur(5px); }
        .spinner { width: 50px; height: 50px; border: 5px solid #eee; border-top: 5px solid var(--gold-main); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .card-scene { width: 100%; max-width: 450px; margin: 0 auto; min-height: 100vh; perspective: 1500px; padding: 30px 20px; box-sizing: border-box; }
        .card-object { width: 100%; position: relative; transform-style: preserve-3d; transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        .card-face { width: 100%; border-radius: 30px; backface-visibility: hidden; background: rgba(255,255,255,0.95); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15); min-height: 850px; display: flex; flex-direction: column; overflow: hidden; }
        .card-front { transform: rotateY(0deg); position: relative; }
        .card-back { position: absolute; top: 0; left: 0; height: 100%; transform: rotateY(180deg); }
        .is-flipped { transform: rotateY(180deg); }

        .weather-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; opacity: 0.6; overflow: hidden; border-radius: 30px; }
        .theme-winter { background: linear-gradient(180deg, #E3F2FD 0%, #FFFFFF 100%); }
        .theme-summer { background: linear-gradient(180deg, #FFF8E1 0%, #FFFFFF 100%); }
        .theme-rain { background: linear-gradient(180deg, #ECEFF1 0%, #FFFFFF 100%); }
        
        .snowflake { position: absolute; width: 5px; height: 5px; background: #fff; border-radius: 50%; animation: fall linear infinite; }
        .rain { width: 2px; height: 30px; background: rgba(0,0,255,0.3); animation: fall 0.5s linear infinite; }
        .sun-glare { position: absolute; top: -80px; right: -80px; width: 300px; height: 300px; background: radial-gradient(circle, rgba(255,255,200,0.6) 0%, rgba(255,255,255,0) 70%); animation: pulse 5s ease-in-out infinite; }
        @keyframes fall { from { transform: translateY(-50px); } to { transform: translateY(800px); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(1.1); opacity: 0.8; } }

        .front-content { position: relative; z-index: 10; padding: 40px 30px; display: flex; flex-direction: column; height: 100%; }
        .logo-container { width: 120px; height: 120px; margin: 0 auto 20px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 4px solid var(--gold-main); animation: float 4s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        .logo-img { width: 90%; height: auto; object-fit: contain; }

        .input-group { position: relative; margin-bottom: 20px; }
        .input-label { position: absolute; top: -10px; left: 15px; background: white; padding: 0 8px; color: var(--green-deep); font-size: 13px; font-weight: bold; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); z-index: 30; }
        .custom-select { width: 100%; padding: 16px; border: 1.5px solid rgba(27,77,62,0.2); border-radius: 16px; font-family: 'Prompt'; font-size: 16px; background: #fff; outline: none; transition: all 0.3s; }
        .btn-gold { background: linear-gradient(135deg, var(--green-deep), #2E7D32); color: white; padding: 18px; width: 100%; border-radius: 16px; font-size: 18px; font-weight: bold; border: none; box-shadow: 0 10px 20px rgba(27,77,62,0.3); cursor: pointer; position: relative; z-index: 20; }
        
        .forecast-box { margin-top: auto; background: rgba(255,255,255,0.85); backdrop-filter: blur(10px); border-radius: 20px; padding: 20px; border: 1px solid white; }
        .utu-badge { background: var(--green-deep); color: white; padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; }
        .vulnerable-box { background: #FFEBEE; border: 1px dashed #EF5350; border-radius: 10px; padding: 10px; margin-bottom: 10px; font-size: 12px; color: #C62828; display: flex; align-items: center; }

        .back-header { padding: 50px 20px 40px; text-align: center; color: white; border-radius: 0 0 40% 40% / 0 0 35px 35px; position: relative; flex-shrink: 0; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .avatar-real { width: 140px; height: 140px; margin: -5px auto 10px; object-fit: contain; border-radius: 50%; background: white; border: 4px solid rgba(255,255,255,0.4); }
        .back-content { flex-grow: 1; overflow-y: auto; padding: 20px; margin-top: -30px; z-index: 10; padding-bottom: 40px; }
        
        .section-title { font-size: 16px; font-weight: bold; color: var(--green-deep); display: flex; align-items: center; margin-top: 15px; margin-bottom: 5px; }
        .section-title i { margin-right: 8px; color: var(--gold-main); font-size: 18px; }
        .helper-text { font-size: 11px; color: #888; margin-bottom: 10px; display: block; font-style: italic; }

        /* Chips */
        .chip-container { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; }
        .chip { padding: 8px 14px; background: white; border: 1px solid #ddd; border-radius: 20px; font-size: 12px; color: #555; cursor: pointer; transition: all 0.2s; user-select: none; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .chip.selected { background: var(--gold-main); color: white; border-color: var(--gold-main); box-shadow: 0 4px 10px rgba(212, 175, 55, 0.4); font-weight: 500; }
        
        .food-box { background: #E8F5E9; border-radius: 16px; padding: 15px; border-left: 4px solid #66BB6A; font-size: 13px; color: #555; margin-bottom: 15px; }
        .food-link-tag { display: inline-block; padding: 6px 12px; margin: 0 6px 8px 0; background: white; border: 1px solid #E0E0E0; border-radius: 20px; font-size: 12px; color: #444; cursor: pointer; }
        
        .save-btn-area { padding: 15px; background: white; border-top: 1px solid #eee; text-align: center; }
        .btn-save { background: #333; color: white; padding: 12px 30px; border-radius: 30px; font-size: 14px; width: 100%; border: none; cursor: pointer; }
        .debug-info { font-size: 10px; color: rgba(255,255,255,0.7); margin-top: 5px; }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen">

    <div id="loading"><div class="spinner"></div><p class="mt-4 text-green-900 font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p></div>

    <div class="card-scene">
        <div id="cardObject" class="card-object">
            <div id="cardFront" class="card-face card-front">
                <div id="weatherContainer" class="weather-container"></div>
                <div class="front-content">
                    <div class="text-center mb-6 relative z-10">
                        <div class="logo-container"><img src="https://img5.pic.in.th/file/secure-sv1/2613be45e1aa0f1e99dd6a6f89e87139.png" class="logo-img"></div>
                        <h1 class="text-2xl font-bold text-gray-800">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</h1>
                        <p class="text-sm text-yellow-700 mt-1 font-medium">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢‡∏Ø ‡∏£‡∏û.‡∏™‡∏∞‡πÄ‡∏î‡∏≤</p>
                    </div>
                    <div class="input-group"><span class="input-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î</span><select id="inputDay" class="custom-select"></select></div>
                    <div class="input-group"><span class="input-label">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</span><select id="inputMonth" class="custom-select"></select></div>
                    <div class="input-group"><span class="input-label">‡∏õ‡∏µ ‡∏û.‡∏®.‡πÄ‡∏Å‡∏¥‡∏î</span><select id="inputYear" class="custom-select"></select></div>
                    <button onclick="startAnalysis()" class="btn-gold mt-4">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</button>
                    <div class="forecast-box">
                        <div class="flex justify-between items-center mb-2 border-b pb-2 border-gray-100">
                            <span class="text-sm font-bold text-green-900"><i class="fas fa-calendar-day mr-1"></i> ‡∏≠‡∏∏‡∏ï‡∏∏‡∏™‡∏°‡∏∏‡∏è‡∏ê‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
                            <span class="text-xs text-gray-500" id="todayDate">...</span>
                        </div>
                        <span class="utu-badge" id="todaySeason">...</span>
                        <div class="vulnerable-box"><i class="fas fa-exclamation-triangle mr-2"></i><div><span class="font-bold">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:</span> <span id="todayVulnerable">...</span></div></div>
                        <p class="text-xs text-gray-600 mb-2" id="todayHealth">...</p>
                    </div>
                </div>
            </div>

            <div id="resultFace" class="card-face card-back">
                <div id="resultHeader" class="back-header">
                    <img id="avatarImg" src="" class="avatar-real hidden">
                    <h2 class="text-2xl font-bold text-white drop-shadow-md" id="resMain">...</h2>
                    <p class="text-white/90 text-xs mt-1 font-light" id="resSub">...</p>
                    <div class="debug-info" id="debugCalc"></div>
                </div>

                <div class="back-content">
                    <div class="section-title"><i class="fas fa-user-circle"></i> ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏¥‡∏™‡∏±‡∏¢</div>
                    <span class="helper-text"><i class="fas fa-hand-pointer mr-1"></i> ‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ó‡πà‡∏≤‡∏ô</span>
                    <div id="traitChips" class="chip-container"></div>

                    <div class="section-title" style="color:#C62828;"><i class="fas fa-heartbeat" style="color:#EF5350;"></i> ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</div>
                    <span class="helper-text"><i class="fas fa-hand-pointer mr-1"></i> ‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡πà‡∏≠‡∏¢</span>
                    <div id="healthChips" class="chip-container"></div>

                    <div class="section-title" style="color:#2E7D32;"><i class="fas fa-utensils"></i> ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏î‡∏∏‡∏•</div>
                    <div class="food-box">
                        <div id="resTasteGood" class="font-bold mb-1 text-green-800"></div>
                        <div id="resTasteGoodReason" class="text-xs text-gray-600 mb-2"></div>
                        <div class="h-px bg-green-200 my-2"></div>
                        <div class="text-xs text-red-500 font-bold mb-1">‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á:</div>
                        <div id="resTasteBad" class="text-xs text-gray-600"></div>
                    </div>

                    <div class="section-title mt-4"><i class="fas fa-images"></i> ‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ)</div>
                    <div id="foodList" class="mb-4"></div>
                    <div id="fruitList" class="mb-6"></div>
                </div>

                <div class="save-btn-area">
                    <button onclick="saveAndReset()" class="btn-save">
                        <i class="fas fa-check-circle mr-2"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIG ---
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyX7ZJvwflkNzhZ1SPPOJZZcJBvh_Bpbc2acOjh6fEcj58fv9wHu4i9M8J5BoCNmIoDbw/exec';
        
        let currentSessionId = "";
        let analysisMeta = {}; 
        let selectedTraits = new Set();
        let selectedHealth = new Set();

        // --- 1. CORE LOGIC (Pongsathorn's Algorithm - MINIFIED & FIXED INTERFACE) ---
        class ThaiLunarCalendar{constructor(){this.startYData=[[1901,0.122733000004352],[1906,0.0191890000045229],[1911,-0.0843549999953059],[1916,-0.187898999995135],[1921,-0.291442999994964],[1926,0.0744250000052413],[1931,-0.0291189999945876],[1936,-0.132662999994416],[1941,-0.236206999994245],[1946,-0.339750999994074],[1951,-0.443294999993903],[1956,-0.0774269999936981],[1961,-0.180970999993527],[1966,-0.284514999993356],[1971,-0.388058999993185],[1976,-0.491602999993014],[1981,-0.595146999992842],[1986,-0.698690999992671],[1991,-0.332822999992466],[1996,-0.436366999992295],[2001,-0.539910999992124],[2006,-0.643454999991953],[2011,0.253001000008218],[2016,0.149457000008389],[2021,-0.484674999991406],[2026,-0.588218999991235],[2031,0.308237000008937],[2036,0.204693000009108],[2041,0.101149000009279],[2046,-0.00239499999055015],[2051,-0.105938999990379],[2056,0.259929000009826],[2061,0.156385000009997],[2066,0.0528410000101682]];this.sDate=[new Date(1902,10,30),new Date(1912,11,8),new Date(1922,10,19),new Date(1932,10,27),new Date(1942,11,7),new Date(1952,10,16),new Date(1962,10,26),new Date(1972,11,5),new Date(1982,10,15),new Date(1992,10,24),new Date(2002,11,4),new Date(2012,10,13),new Date(2022,10,23),new Date(2032,11,2),new Date(2042,11,12),new Date(2052,10,21),new Date(2062,11,1),new Date(2072,11,9)];}xlMod(a,b){return a-b*Math.floor(a/b)}athikaMas(i){let a=this.xlMod((i-78)-0.45222,2.7118886);return a<1}athikaVar(i){if(this.athikaMas(i))return!1;let c;if(this.athikaMas(i+1))c=0.0169501433191599;else c=-0.0142223099315486;return this.deviation(i)>c}deviation(y){let f=0,fy=0,c=0,l=0;for(let k=0;k<this.startYData.length;k++){if(y>=this.startYData[k][0]){fy=this.startYData[k][0];f=this.startYData[k][1]}else break}if(fy===0)return 0;if(y===fy)c=f;else{fy++;for(let i=fy;i<=y;i++){if(i===fy)l=f;else l=c;if(this.athikaMas(i-1))c=-0.102356;else if(this.athikaVar(i-1))c=-0.632944;else c=0.367056;c=l+c}}return c}lDayInYear(i){if(this.athikaMas(i))return 384;else if(this.athikaVar(i))return 355;else return 354}getThaiLunarDate(d){const y=d.getFullYear();if(y<1903||y>2082)return null;let b;const cy=y-1;const sy=1902;let bk=Math.floor((cy-sy)/10);if(bk<0)bk=0;if(bk>17)bk=17;b=new Date(this.sDate[bk]);let t=new Date(b);for(let i=b.getFullYear()+1;i<=y-1;i++){t.setDate(t.getDate()+this.lDayInYear(i))}b=new Date(t);let ep=new Date(b.getFullYear(),11,31);let rp=Math.round((ep-b)/(86400000));let sc=new Date(y,0,1);let dy=Math.round((d-sc)/(86400000));let df=rp+dy+1;let ny=this.lDayInYear(y);let dof=df,tm,ts;let md=[];if(ny===354)md=[29,30,29,30,29,30,29,30,29,30,29,30,29,30];else if(ny===355)md=[29,30,29,30,29,30,30,30,29,30,29,30,29,30];else if(ny===384)md=[29,30,29,30,29,30,29,30,30,29,30,29,30,29,30];for(let j=0;j<md.length;j++){tm=j+1;if(dof<=md[j]&&dof>0)break;else dof-=md[j]}if(ny===384){if(tm>13)tm-=13;if(tm===9)tm=88;else if(tm>=10)tm=tm-1}else{if(tm>12)tm-=12}if(dof>15){ts="Waning";dof-=15}else{ts="Waxing"}const tn=["‡πê","‡πë","‡πí","‡πì","‡πî","‡πï","‡πñ","‡πó","‡πò","‡πô"];const tt=(n)=>n.toString().split('').map(x=>tn[x]||x).join('');let mdsp=tm;if(tm==88)mdsp="‡πò‡πò";else mdsp=tt(tm);return{phase:ts,day:dof,month:tm,year:y,display:`${ts=='Waxing'?'‡∏Ç‡∏∂‡πâ‡∏ô':'‡πÅ‡∏£‡∏°'} ${tt(dof)} ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${mdsp}`}}}
        
        const calendar = new ThaiLunarCalendar();

        // üü¢ ADAPTER FUNCTION (‡∏ï‡∏±‡∏ß‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°): ‡πÅ‡∏õ‡∏•‡∏á output ‡∏Ç‡∏≠‡∏á Class ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà Logic ‡πÄ‡∏î‡∏¥‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        function calculateRealLunarDate(date) {
            const lunar = calendar.getThaiLunarDate(date);
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ thaiMonth ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Object ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Logic ‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
            return { ...lunar, thaiMonth: lunar.month };
        }

        // --- 2. DATASET (Modified to Array for Buttons) ---
        const baseElementData = {
            earth: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô (‡∏õ‡∏ñ‡∏ß‡∏µ)",
                traits: ["‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏™‡∏π‡∏á‡πÉ‡∏´‡∏ç‡πà", "‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á", "‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡πÉ‡∏´‡∏ç‡πà", "‡∏ú‡∏°‡∏î‡∏Å‡∏î‡∏≥‡∏´‡∏ô‡∏≤", "‡∏û‡∏π‡∏î‡∏à‡∏≤‡∏â‡∏∞‡∏â‡∏≤‡∏ô", "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á", "‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏ô‡πà‡∏ô", "‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö", "‡∏à‡∏¥‡∏ï‡πÉ‡∏à‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á", "‡∏î‡∏∑‡πâ‡∏≠‡∏£‡∏±‡πâ‡∏ô"],
                recTaste: "‡∏ù‡∏≤‡∏î, ‡∏´‡∏ß‡∏≤‡∏ô, ‡∏°‡∏±‡∏ô, ‡πÄ‡∏Ñ‡πá‡∏°",
                recReason: "‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏™‡∏°‡∏≤‡∏ô‡πÅ‡∏ú‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (‡∏ù‡∏≤‡∏î) ‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á (‡∏´‡∏ß‡∏≤‡∏ô/‡∏°‡∏±‡∏ô/‡πÄ‡∏Ñ‡πá‡∏°)",
                badTaste: "‡∏°‡∏±‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ, ‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ",
                badReason: "‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏≤‡∏ú‡∏•‡∏≤‡∏ç‡∏¢‡∏≤‡∏Å ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô‡∏Å‡∏≥‡πÄ‡∏£‡∏¥‡∏ö (‡∏≠‡πâ‡∏ß‡∏ô/‡πÑ‡∏Ç‡∏°‡∏±‡∏ô)",
                foods: ["‡∏ú‡∏±‡∏Å‡∏Å‡∏π‡∏î", "‡πÅ‡∏Å‡∏á‡πÄ‡∏•‡∏µ‡∏¢‡∏á", "‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ", "‡∏°‡∏±‡∏™‡∏°‡∏±‡πà‡∏ô (‡∏û‡∏≠‡∏î‡∏µ)", "‡∏û‡∏∞‡πÇ‡∏•‡πâ", "‡∏£‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤", "‡∏¢‡∏≥‡∏ñ‡∏±‡πà‡∏ß‡∏û‡∏π"],
                fruits: ["‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î", "‡∏ù‡∏£‡∏±‡πà‡∏á‡∏î‡∏¥‡∏ö", "‡∏ü‡∏±‡∏Å‡∏ó‡∏≠‡∏á", "‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å", "‡∏ñ‡∏±‡πà‡∏ß‡∏ï‡πà‡∏≤‡∏á‡πÜ", "‡πÄ‡∏á‡∏≤‡∏∞", "‡∏ô‡πâ‡∏≥‡∏ô‡∏°", "‡∏≠‡πâ‡∏≠‡∏¢"]
            },
            fire: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü (‡πÄ‡∏ï‡πÇ‡∏ä)",
                traits: ["‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏™‡∏°‡∏™‡πà‡∏ß‡∏ô", "‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏ß‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á", "‡∏û‡∏π‡∏î‡∏ä‡∏±‡∏î", "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á", "‡∏´‡∏¥‡∏ß‡∏ö‡πà‡∏≠‡∏¢", "‡∏Å‡∏¥‡∏ô‡∏à‡∏∏", "‡∏Ç‡∏µ‡πâ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î", "‡πÇ‡∏Å‡∏£‡∏ò‡∏á‡πà‡∏≤‡∏¢‡∏´‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß", "‡∏ú‡∏°‡∏´‡∏á‡∏≠‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏¢"],
                recTaste: "‡∏Ç‡∏°, ‡πÄ‡∏¢‡πá‡∏ô, ‡∏à‡∏∑‡∏î",
                recReason: "‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô ‡∏î‡∏±‡∏ö‡∏û‡∏¥‡∏©‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢",
                badTaste: "‡∏£‡∏™‡∏à‡∏±‡∏î (‡πÄ‡∏ú‡πá‡∏î/‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß/‡πÄ‡∏Ñ‡πá‡∏°), ‡∏£‡πâ‡∏≠‡∏ô",
                badReason: "‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÄ‡∏£‡∏¥‡∏ö ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏Ç‡πâ ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î",
                foods: ["‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î‡∏ï‡∏≥‡∏•‡∏∂‡∏á", "‡∏ï‡πâ‡∏°‡∏ü‡∏±‡∏Å", "‡∏ú‡∏±‡∏î‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á", "‡πÅ‡∏ï‡∏á‡∏Å‡∏ß‡∏≤‡∏ú‡∏±‡∏î‡πÑ‡∏Ç‡πà", "‡πÅ‡∏Å‡∏á‡∏™‡πâ‡∏° (‡πÑ‡∏°‡πà‡πÄ‡∏ú‡πá‡∏î‡∏°‡∏≤‡∏Å)", "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏´‡∏ô‡∏∏‡πà‡∏°"],
                fruits: ["‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "‡πÅ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏•‡∏π‡∏õ", "‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏±‡∏á‡∏Å‡∏£", "‡∏ä‡∏°‡∏û‡∏π‡πà", "‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î", "‡∏™‡πâ‡∏°‡πÇ‡∏≠"]
            },
            wind: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏° (‡∏ß‡∏≤‡πÇ‡∏¢)",
                traits: ["‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ú‡∏≠‡∏°", "‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á", "‡∏ú‡∏°‡∏ö‡∏≤‡∏á", "‡∏û‡∏π‡∏î‡πÄ‡∏¢‡∏≠‡∏∞", "‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô", "‡∏Ç‡∏µ‡πâ‡∏Å‡∏•‡∏±‡∏ß", "‡∏ß‡∏¥‡∏ï‡∏Å‡∏Å‡∏±‡∏á‡∏ß‡∏•", "‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏´‡πá‡∏ô", "‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å"],
                recTaste: "‡πÄ‡∏ú‡πá‡∏î‡∏£‡πâ‡∏≠‡∏ô, ‡∏™‡∏∏‡∏Ç‡∏∏‡∏°",
                recReason: "‡∏ä‡πà‡∏ß‡∏¢‡∏Ç‡∏±‡∏ö‡∏•‡∏° ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏•‡∏° ‡πÅ‡∏Å‡πâ‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏ü‡πâ‡∏≠",
                badTaste: "‡∏£‡∏™‡∏à‡∏±‡∏î‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ, ‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏±‡∏Å‡∏î‡∏≠‡∏á",
                badReason: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏°‡∏´‡∏∞‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏Ç‡πâ‡∏ô ‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏•‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å",
                foods: ["‡∏ï‡πâ‡∏°‡∏¢‡∏≥", "‡∏Ç‡πà‡∏≤‡πÑ‡∏Å‡πà", "‡πÅ‡∏Å‡∏á‡∏õ‡πà‡∏≤", "‡∏ú‡∏±‡∏î‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤", "‡πÑ‡∏Å‡πà‡∏ú‡∏±‡∏î‡∏Ç‡∏¥‡∏á", "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏Ç‡∏¥‡∏á"],
                fruits: ["‡∏™‡πâ‡∏°", "‡πÄ‡∏á‡∏≤‡∏∞", "‡∏™‡∏•‡∏∞", "‡∏•‡∏≠‡∏á‡∏Å‡∏≠‡∏á", "‡∏•‡∏≥‡πÑ‡∏¢", "‡∏ô‡πâ‡∏≥‡∏Ç‡∏¥‡∏á"]
            },
            water: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥ (‡∏≠‡∏≤‡πÇ‡∏õ)",
                traits: ["‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡∏≠‡∏ß‡∏ö", "‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏ß", "‡∏ï‡∏≤‡πÇ‡∏ï", "‡∏û‡∏π‡∏î‡∏ä‡πâ‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏û‡πÄ‡∏£‡∏≤‡∏∞", "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ä‡πâ‡∏≤", "‡∏ú‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏ß‡∏¢", "‡∏ú‡∏°‡∏î‡∏Å‡∏î‡∏≥", "‡∏ä‡∏≠‡∏ö‡∏ô‡∏≠‡∏ô", "‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô"],
                recTaste: "‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß, ‡∏Ç‡∏°, ‡∏£‡πâ‡∏≠‡∏ô",
                recReason: "‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏±‡∏î‡πÄ‡∏™‡∏°‡∏´‡∏∞ (‡πÄ‡∏™‡∏°‡∏´‡∏∞) ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÇ‡∏•‡∏´‡∏¥‡∏ï ‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô",
                badTaste: "‡∏´‡∏ß‡∏≤‡∏ô‡∏à‡∏±‡∏î, ‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß‡∏à‡∏±‡∏î, ‡πÄ‡∏Ñ‡πá‡∏°‡∏à‡∏±‡∏î",
                badReason: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡∏°‡∏´‡∏∞ ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏ö‡∏ß‡∏°‡∏á‡πà‡∏≤‡∏¢",
                foods: ["‡πÅ‡∏Å‡∏á‡∏™‡πâ‡∏°‡∏î‡∏≠‡∏Å‡πÅ‡∏Ñ", "‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏õ‡∏•‡∏≤", "‡∏´‡πà‡∏≠‡∏´‡∏°‡∏Å", "‡πÅ‡∏Å‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á", "‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏°‡∏∞‡∏Ç‡∏≤‡∏°", "‡∏™‡πâ‡∏°‡∏ï‡∏≥"],
                fruits: ["‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", "‡∏°‡∏∞‡πÄ‡∏ü‡∏∑‡∏≠‡∏á", "‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏°", "‡∏ï‡∏∞‡∏•‡∏¥‡∏á‡∏õ‡∏•‡∏¥‡∏á"]
            },
            fire_wind: {
                name: "‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü‡∏£‡∏∞‡∏Ñ‡∏ô‡∏•‡∏° (‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠‡∏¢‡∏ï‡πà‡∏≠)",
                traits: ["‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô", "‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î‡∏á‡πà‡∏≤‡∏¢ (‡πÑ‡∏ü)", "‡∏Ç‡∏µ‡πâ‡∏Å‡∏±‡∏á‡∏ß‡∏• (‡∏•‡∏°)", "‡∏û‡∏π‡∏î‡πÄ‡∏£‡πá‡∏ß", "‡∏Ñ‡∏¥‡∏î‡πÄ‡∏£‡πá‡∏ß"],
                recTaste: "‡∏à‡∏∑‡∏î, ‡∏´‡∏≠‡∏°‡πÄ‡∏¢‡πá‡∏ô, ‡∏™‡∏∏‡∏Ç‡∏∏‡∏°",
                recReason: "‡∏î‡∏±‡∏ö‡∏û‡∏¥‡∏©‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏®‡∏µ‡∏£‡∏©‡∏∞",
                badTaste: "‡πÄ‡∏ú‡πá‡∏î‡∏à‡∏±‡∏î, ‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î",
                badReason: "‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏•‡∏°‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡πÄ‡∏£‡∏¥‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô",
                foods: ["‡πÅ‡∏Å‡∏á‡∏à‡∏∑‡∏î", "‡∏õ‡∏•‡∏≤‡∏ô‡∏∂‡πà‡∏á", "‡∏ú‡∏±‡∏î‡∏Ç‡∏¥‡∏á (‡∏≠‡πà‡∏≠‡∏ô‡πÜ)", "‡∏ô‡πâ‡∏≥‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏§‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏¢‡πá‡∏ô"],
                fruits: ["‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "‡∏™‡πâ‡∏°‡πÇ‡∏≠", "‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏±‡∏á‡∏Å‡∏£"]
            }
        };

        const sadaoData = [
            // EARTH -> Split health string to Array
            { check: (m, p) => (m==1 && p=='Waning') || (m==2 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πí", baseElement: "earth", 
              health: ["‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å", "‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢‡∏•‡∏≥‡∏ö‡∏≤‡∏Å", "‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á", "‡∏•‡∏°‡∏ï‡∏¥‡∏î‡πÉ‡∏ô‡πÄ‡∏™‡πâ‡∏ô"] },
            { check: (m, p) => (m==2 && p=='Waning') || (m==3 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πí - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πì", baseElement: "earth", 
              health: ["‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏î", "‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏≠‡∏¥‡πà‡∏°", "‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢‡∏á‡πà‡∏≤‡∏¢"] },
            { check: (m, p) => (m==3 && p=='Waning') || (m==4 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πì - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πî", baseElement: "earth", 
              health: ["‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏´‡∏•‡∏ß‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢", "‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô", "‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô", "‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞"] },
            
            // FIRE
            { check: (m, p) => (m==4 && p=='Waning') || (m==5 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πî - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πï", baseElement: "fire", 
              health: ["‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏°", "‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏∑‡∏î", "‡πÑ‡∏Ç‡πâ‡πÅ‡∏î‡∏î", "‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô", "‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å"] },
            // Gap 5-6
            { check: (m, p) => (m==5 && p=='Waning') || (m==6 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πï - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πñ", baseElement: "fire", 
              health: ["‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô", "‡∏Å‡∏£‡∏∞‡∏´‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô"] },
            { check: (m, p) => (m==6 && p=='Waning') || (m==7 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πñ - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πó", baseElement: "fire", 
              health: ["‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï", "‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô", "‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å", "‡∏ï‡∏∑‡πà‡∏ô‡∏á‡πà‡∏≤‡∏¢"] },
            
            // OVERLAP 8-9
            { check: (m, p) => (m==8 && p=='Waning') || (m==9 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πò - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πô", baseElement: "fire_wind", 
              health: ["‡∏õ‡∏ß‡∏î‡∏®‡∏µ‡∏£‡∏©‡∏∞", "‡∏õ‡∏ß‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏ï‡∏≤", "‡∏´‡∏π‡∏≠‡∏∑‡πâ‡∏≠", "‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô", "‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î", "‡πÅ‡∏ô‡πà‡∏ô‡∏ó‡πâ‡∏≠‡∏á"] },
            
            // WIND
            { check: (m, p) => (m==7 && p=='Waning') || (m==8 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πó - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πò", baseElement: "wind", 
              health: ["‡πÑ‡∏≠", "‡∏£‡∏∞‡∏Ñ‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏∑‡∏≠‡∏á‡∏Ñ‡∏≠", "‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏≠", "‡∏à‡∏∏‡∏Å‡∏Ñ‡∏≠", "‡∏•‡∏°‡∏ï‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô"] },
            { check: (m, p) => (m==9 && p=='Waning') || (m==10 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πô - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πê", baseElement: "wind", 
              health: ["‡∏Å‡∏£‡∏î‡πÑ‡∏´‡∏•‡∏¢‡πâ‡∏≠‡∏ô", "‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏ü‡πâ‡∏≠", "‡∏ó‡πâ‡∏≠‡∏á‡∏ö‡∏¥‡∏î", "‡πÅ‡∏™‡∏ö‡∏£‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏Å", "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏¢‡πà‡∏≠‡∏¢"] },
            
            // WATER
            { check: (m, p) => (m==10 && p=='Waning') || (m==11 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πê - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πë", baseElement: "water", 
              health: ["‡∏õ‡∏ß‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠", "‡∏õ‡∏ß‡∏î‡πÄ‡∏Ç‡πà‡∏≤", "‡∏õ‡∏ß‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å", "‡∏£‡∏¥‡∏î‡∏™‡∏µ‡∏î‡∏ß‡∏á", "‡∏ù‡∏µ", "‡∏™‡∏¥‡∏ß"] },
            { check: (m, p) => (m==11 && p=='Waning') || (m==12 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πë - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πí", baseElement: "water", 
              health: ["‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ", "‡∏´‡∏ß‡∏±‡∏î", "‡∏ô‡πâ‡∏≥‡∏°‡∏π‡∏Å", "‡∏Å‡∏£‡∏ô", "‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î", "‡πÅ‡∏ô‡πà‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å"] },
            { check: (m, p) => (m==12 && p=='Waning') || (m==1 && p=='Waxing'), range: "‡πÅ‡∏£‡∏° ‡πë ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë‡πí - ‡∏Ç‡∏∂‡πâ‡∏ô ‡πë‡πï ‡∏Ñ‡πà‡∏≥ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πë", baseElement: "water", 
              health: ["‡∏ú‡∏î‡∏ú‡∏∑‡πà‡∏ô", "‡∏™‡∏¥‡∏ß", "‡∏•‡∏°‡∏û‡∏¥‡∏©", "‡∏Ñ‡∏±‡∏ô‡∏á‡πà‡∏≤‡∏¢", "‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á"] }
        ];

        const seasonData = {
            summer: { name: "‡∏Ñ‡∏¥‡∏°‡∏´‡∏±‡∏ô‡∏ï‡∏§‡∏î‡∏π (‡∏£‡πâ‡∏≠‡∏ô)", vul: "‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü", health: "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏•‡∏°‡πÅ‡∏î‡∏î ‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô ‡∏Å‡∏£‡∏∞‡∏´‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", food: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡∏Ç‡∏° ‡πÄ‡∏¢‡πá‡∏ô ‡∏à‡∏∑‡∏î", theme: "summer", fx: "sun" },
            rain: { name: "‡∏ß‡∏™‡∏±‡∏ô‡∏ï‡∏§‡∏î‡∏π (‡∏ù‡∏ô)", vul: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏°/‡πÑ‡∏ü", health: "‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î ‡∏ß‡∏¥‡∏á‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô ‡∏®‡∏µ‡∏£‡∏©‡∏∞", food: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡πÄ‡∏õ‡∏£‡∏µ‡πâ‡∏¢‡∏ß ‡πÄ‡∏ú‡πá‡∏î‡∏£‡πâ‡∏≠‡∏ô", theme: "rain", fx: "rain" },
            winter: { name: "‡πÄ‡∏´‡∏°‡∏±‡∏ô‡∏ï‡∏§‡∏î‡∏π (‡∏´‡∏ô‡∏≤‡∏ß)", vul: "‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥/‡∏î‡∏¥‡∏ô", health: "‡∏ú‡∏¥‡∏ß‡πÅ‡∏´‡πâ‡∏á ‡∏õ‡∏ß‡∏î‡∏Ç‡πâ‡∏≠ ‡∏ô‡πâ‡∏≥‡∏°‡∏π‡∏Å‡πÑ‡∏´‡∏•", food: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡∏°‡∏±‡∏ô ‡πÄ‡∏Ñ‡πá‡∏° ‡∏£‡πâ‡∏≠‡∏ô", theme: "winter", fx: "snow" }
        };

        // --- 3. APP FUNCTIONS ---
        window.onload = function() {
            currentSessionId = 'u' + Date.now() + 'r' + Math.floor(Math.random()*1000);
            
            const dS = document.getElementById('inputDay'); for(let i=1; i<=31; i++) { let o = document.createElement('option'); o.value=i; o.innerText=i; dS.appendChild(o); }
            const mS = document.getElementById('inputMonth'); const months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"]; months.forEach((m,i)=>{ let o=document.createElement('option'); o.value=i+1; o.innerText=m; mS.appendChild(o); });
            const yS = document.getElementById('inputYear'); const curY = new Date().getFullYear(); for(let i=0; i<100; i++) { let y = curY-i; let o = document.createElement('option'); o.value = y; o.innerText = y+543; yS.appendChild(o); } yS.value = curY-30;
            
            updateDailyForecast();
        }

        function getDailySeason(m) { if (m>=5 && m<=6) return seasonData.summer; if (m>=7 && m<=10) return seasonData.rain; return seasonData.winter; }

        function updateDailyForecast() {
            const today = new Date(); const lunar = calculateRealLunarDate(today); if(!lunar) return;
            
            // FIX: ‡πÉ‡∏ä‡πâ checkMonth ‡∏à‡∏≤‡∏Å lunar.thaiMonth (‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô Adapter ‡πÅ‡∏•‡πâ‡∏ß)
            let checkM = lunar.thaiMonth; 
            if(checkM==88) checkM=8;
            
            const season = getDailySeason(checkM);
            const mTh = ["‡∏°.‡∏Ñ.","‡∏Å.‡∏û.","‡∏°‡∏µ.‡∏Ñ.","‡πÄ‡∏°.‡∏¢.","‡∏û.‡∏Ñ.","‡∏°‡∏¥.‡∏¢.","‡∏Å.‡∏Ñ.","‡∏™.‡∏Ñ.","‡∏Å.‡∏¢.","‡∏ï.‡∏Ñ.","‡∏û.‡∏¢.","‡∏ò.‡∏Ñ."];
            document.getElementById('todayDate').innerText = `${today.getDate()} ${mTh[today.getMonth()]} ${today.getFullYear()+543}`;
            document.getElementById('todaySeason').innerText = season.name;
            document.getElementById('todayVulnerable').innerText = season.vul;
            document.getElementById('todayHealth').innerText = season.health;
            document.getElementById('todayFood').innerText = season.f; // Fix: use season.f directly from legacy code if needed or season.food from seasonData
            
            // Adjust to use seasonData property names
            document.getElementById('todayFood').innerText = season.food;

            const div = document.getElementById('weatherContainer'); div.innerHTML='';
            const front = document.getElementById('cardFront');
            front.classList.remove('theme-winter','theme-summer','theme-rain'); front.classList.add(`theme-${season.theme}`);
            if(season.fx=='rain') { for(let i=0;i<30;i++){ let d=document.createElement('div'); d.className='rain'; d.style.left=Math.random()*100+'%'; d.style.animationDuration=(0.5+Math.random())+'s'; div.appendChild(d); }}
            else if(season.fx=='sun') { let s=document.createElement('div'); s.className='sun-glare'; div.appendChild(s); }
            else { for(let i=0;i<30;i++){ let s=document.createElement('div'); s.className='snowflake'; s.style.left=Math.random()*100+'%'; s.style.animationDuration=(3+Math.random()*2)+'s'; div.appendChild(s); }}
        }

        function createChips(items, containerId, selectionSet) {
            const c = document.getElementById(containerId); c.innerHTML = '';
            items.forEach(item => {
                const chip = document.createElement('div');
                chip.className = 'chip';
                chip.innerText = item;
                chip.onclick = function() {
                    this.classList.toggle('selected');
                    if(this.classList.contains('selected')) selectionSet.add(item);
                    else selectionSet.delete(item);
                };
                c.appendChild(chip);
            });
        }

        function createFoodTags(items, id) {
            const c = document.getElementById(id); c.innerHTML='';
            items.forEach(i => {
                let a = document.createElement('a'); a.className='food-link-tag';
                a.innerHTML = `${i} <i class="fas fa-search text-xs ml-1 text-gray-400"></i>`;
                a.href = `https://www.google.com/search?tbm=isch&q=${i} ‡∏≠‡∏≤‡∏´‡∏≤‡∏£`; a.target = '_blank'; c.appendChild(a);
            });
        }

        function logToGoogleSheet(data) {
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST', mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).catch(e => console.error("Log Error:", e));
        }

        async function startAnalysis() {
            document.getElementById('loading').style.display = 'flex';
            
            setTimeout(async () => {
                try {
                    const d = parseInt(document.getElementById('inputDay').value);
                    const m = parseInt(document.getElementById('inputMonth').value);
                    const y = parseInt(document.getElementById('inputYear').value);
                    
                    let birthDate = new Date(y, m-1, d);
                    let conceptionDate = new Date(birthDate); conceptionDate.setMonth(birthDate.getMonth()-9);
                    const lunar = calculateRealLunarDate(conceptionDate);
                    
                    if (!lunar) { alert("‡∏õ‡∏µ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö"); document.getElementById('loading').style.display = 'none'; return; }

                    // FIX: ‡πÉ‡∏ä‡πâ lunar.thaiMonth ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô Adapter ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß
                    let checkMonth = lunar.thaiMonth; 
                    if (checkMonth == 88) checkMonth = 8;
                    
                    let key = "earth"; let specificHealthArr = []; let range = ""; let matched = false;

                    for (let rule of sadaoData) {
                        // FIX: ‡πÉ‡∏ä‡πâ lunar.thaiMonth
                        if (rule.check(checkMonth, lunar.phase)) {
                            key = rule.baseElement; 
                            specificHealthArr = rule.health; 
                            range = rule.range; 
                            matched = true; 
                            break;
                        }
                    }
                    
                    if(!matched) {
                        if(checkMonth >= 1 && checkMonth <= 4) { key="earth"; specificHealthArr=["‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å"]; }
                        else if(checkMonth >= 5 && checkMonth <= 7) { key="fire"; specificHealthArr=["‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô"]; }
                        else if(checkMonth >= 8 && checkMonth <= 10) { key="wind"; specificHealthArr=["‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î"]; }
                        else { key="water"; specificHealthArr=["‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏û‡πâ"]; }
                    }

                    const data = baseElementData[key];
                    
                    // Clear old selections
                    selectedTraits.clear();
                    selectedHealth.clear();
                    
                    // Save meta
                    analysisMeta = {
                        sessionId: currentSessionId,
                        birthDate: `${d}/${m}/${y+543}`,
                        element: data.name,
                        conceptionDate: lunar.display
                    };

                    // UI Updates
                    document.getElementById('resMain').innerText = data.name;
                    document.getElementById('resSub').innerText = range; 
                    document.getElementById('debugCalc').innerText = `(‡∏õ‡∏è‡∏¥‡∏™‡∏ô‡∏ò‡∏¥: ${lunar.display})`;
                    
                    document.getElementById('avatarImg').src = key.includes("fire") ? "https://img5.pic.in.th/file/secure-sv1/41a8f63dde1ba7c4b.png" : (key.includes("wind") ? "https://img2.pic.in.th/261c90e765ec6b116.png" : (key.includes("water") ? "https://img5.pic.in.th/file/secure-sv1/3141eb0166e3e7f51.png" : "https://img2.pic.in.th/1c8b450894dd6fe8e.png"));
                    document.getElementById('avatarImg').classList.remove('hidden');
                    
                    let color = "";
                    if(key.includes("fire")) color = "linear-gradient(135deg, #FF9966, #FF5E62)";
                    else if(key.includes("wind")) color = "linear-gradient(135deg, #56ab2f, #a8e063)";
                    else if(key.includes("water")) color = "linear-gradient(135deg, #36D1DC, #5B86E5)";
                    else color = "linear-gradient(135deg, #CAC531, #F3F9A7)";
                    document.getElementById('resultHeader').style.background = color;

                    createChips(data.traits, 'traitChips', selectedTraits);
                    createChips(specificHealthArr, 'healthChips', selectedHealth);

                    document.getElementById('resTasteGood').innerText = data.recTaste;
                    document.getElementById('resTasteGoodReason').innerText = data.recReason;
                    document.getElementById('resTasteBad').innerHTML = `<span class="font-bold text-red-800">${data.badTaste}</span><br>${data.badReason}`;
                    
                    createFoodTags(data.foods, 'foodList');
                    createFoodTags(data.fruits, 'fruitList');

                    document.getElementById('cardObject').classList.add('is-flipped');
                    document.getElementById('loading').style.display = 'none';

                    // 2. Log Data in Background (Don't wait)
                    logToGoogleSheet({
                        type: 'analysis',
                        sessionId: currentSessionId,
                        timestamp: new Date().toISOString(),
                        ...analysisMeta
                    });

                } catch (e) {
                    console.error(e);
                    alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•");
                    document.getElementById('loading').style.display = 'none';
                }
            }, 100);
        }

        async function saveAndReset() {
            document.getElementById('loading').style.display = 'flex';
            
            // Prepare Data
            const payload = {
                ...analysisMeta,
                type: 'feedback',
                selectedTraits: Array.from(selectedTraits).join(", "),
                selectedHealth: Array.from(selectedHealth).join(", "),
                timestamp: new Date().toISOString()
            };

            // Send to Google Sheet (Fire & Forget for speed, or await if you must confirm)
            // Using Fire & Forget strategy to make it fast for user
            logToGoogleSheet(payload);

            // Fake delay for UX (0.8s) then reset
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('cardObject').classList.remove('is-flipped');
                currentSessionId = 'u' + Date.now() + 'r' + Math.floor(Math.random()*1000);
                alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö");
            }, 800);
        }

        function resetCard() { document.getElementById('cardObject').classList.remove('is-flipped'); }
    </script>
</body>
</html>
